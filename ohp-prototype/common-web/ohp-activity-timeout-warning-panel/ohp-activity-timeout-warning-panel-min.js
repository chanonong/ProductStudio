/*
 * Copyright (c) Orchestral Developments Ltd (2001 - 2014).
 *
 * This document is copyright. Except for the purpose of fair reviewing, no part
 * of this publication may be reproduced or transmitted in any form or by any
 * means, electronic or mechanical, including photocopying, recording, or any
 * information storage and retrieval system, without permission in writing from
 * the publisher. Infringers of copyright render themselves liable for
 * prosecution.
 */
YUI.add("ohp-activity-timeout-warning-panel",function(e,t){"use strict";var n=e.OHP.Locale,r=e.OHP.OhpClassNameManager.getClassName,i=2e4,s="<div>"+n.get("cow.activityTimeout.warningPanel.message.inactivityDetected")+"</div>"+'<div class="cow-activity-timeout-warning-countdown" '+'role="timer" '+'aria-live="polite" '+'aria-atomic="true" '+'aria-relevant="all">'+"</div>",o;o=e.Base.create("ohp-activity-timeout-warning-panel",e.Panel,[],{initializer:function(){this._eventSubscriptions=[],e.publish("ohp-activity-timeout:warningDismissed",{broadcast:2}),e.publish("ohp-activity-timeout:warningTimeout",{broadcast:2})},destructor:function(){this._cancelWarningTimer(),e.Array.invoke(this._eventSubscriptions,"detach")},bindUI:function(){this._eventSubscriptions.push(this.after("visibleChange",this._afterVisibleChange,this),e.on("windowresize",function(){this.centered()},this))},dismiss:function(){this.get("visible")&&(e.fire("ohp-activity-timeout:warningDismissed"),this.hide())},_cancelWarningTimer:function(){this._warningTimeoutTimer&&(this._warningTimeoutTimer.cancel(),this._warningTimeoutTimer=null)},_afterVisibleChange:function(t){var n=t.newVal,r,i;if(!n){this._cancelWarningTimer();return}this.centered(),r=e.OHP.ActivityTimeout.WarningPanel._WARNING_COUNT_DOWN_TIME/1e3,i=this.get("contentBox").one(".cow-activity-timeout-warning-countdown"),i.set("text",r),this._warningTimeoutTimer=e.later(1e3,this,function(){r-=1,r===0&&(this._cancelWarningTimer(),e.fire("ohp-activity-timeout:warningTimeout")),i.set("text",r)},[],!0)}},{ATTRS:{headerContent:{value:n.get("cow.activityTimeout.warningPanel.heading.automaticLogout")},bodyContent:{value:s},modal:{value:!0},visible:{value:!1},zIndex:{value:99999999},buttons:{value:[{name:"dismiss",label:n.get("cow.activityTimeout.warningPanel.action.dismiss"),isDefault:!0,action:"dismiss"}]}},CSS_PREFIX:r("activity","timeout","warning","panel"),_WARNING_COUNT_DOWN_TIME:i}),e.namespace("OHP.ActivityTimeout").WarningPanel=o},"7.9.0",{requires:["base","node-base","event-base","event-custom","event-resize","panel","ohp-locale-translations","ohp-locale-base","ohp-ohp-class-name-manager"],skinnable:!0});
