/*
 * Copyright (c) Orchestral Developments Ltd (2001 - 2014).
 *
 * This document is copyright. Except for the purpose of fair reviewing, no part
 * of this publication may be reproduced or transmitted in any form or by any
 * means, electronic or mechanical, including photocopying, recording, or any
 * information storage and retrieval system, without permission in writing from
 * the publisher. Infringers of copyright render themselves liable for
 * prosecution.
 */
YAHOO.namespace("ORCHESTRAL.widget"),function(){var e=YAHOO.util.Event,t=YAHOO.util.Dom,n=YAHOO.lang,r=function(e,i){if(!t.get(e))return;this.viewportWidth=null,this.viewportHeight=null,this.initialZIndex=null,t.setStyle(e,"display","block"),i=n.merge({autofillheight:"body",draggable:!1,fixedcenter:YAHOO.env.ua.mobile?!1:"contained",naturalwidth:t.hasClass(e,"natural-content-width"),modal:!0,underlay:"shadow",visible:!1},i||{}),r.superclass.constructor.call(this,e,i),i=i||{},i.sidebar&&t.addClass(this.element,"lightbox-sidebar-enabled"),t[i.naturalwidth?"addClass":"removeClass"](e,"natural-content-width"),i.width&&t.removeClass(e,"natural-content-width"),(Math.floor(ORCHESTRAL.env.ua.gecko)===2||Math.floor(ORCHESTRAL.env.ua.gecko)===5||Math.floor(ORCHESTRAL.env.ua.gecko)===6)&&this.changeBodyEvent.subscribe(function(e){t.setStyle(this.body,"height","auto"),this.resize()}),t.setStyle(this.body,"height","auto"),i.visible||t.addClass(this.element,"cow-lightbox-hidden"),this.render(),this.resize(),YAHOO.env.ua.mobile?YAHOO.util.Event.on(window,"orientationchange",function(e){this.resize()},this,!0):(YAHOO.widget.Overlay.windowResizeEvent.subscribe(function(){if(this.viewportWidth===t.getViewportWidth()&&this.viewportHeight===t.getViewportHeight())return;this.resize()},null,this),YAHOO.widget.Overlay.windowScrollEvent.subscribe(this.resize,null,this)),this.beforeShowEvent.subscribe(function(){t.removeClass(this.element,"cow-lightbox-hidden")}),this.showEvent.subscribe(function(){t.setStyle(this.body,"height","auto"),this.resize()})};n.extend(r,YAHOO.widget.Dialog,{registerForm:function(){var n=this.element.getElementsByTagName("form")[0];if(this.form){if(this.form==n&&t.isAncestor(this.element,this.form))return;e.purgeElement(this.form),this.form=null}n&&(this.form=n,e.on(n,"submit",this._submitHandler,this,!0))},_onElementFocus:function(e){t.isAncestor("OrchestralCalendar",YAHOO.util.Event.getTarget(e))||r.superclass._onElementFocus.call(this,e)},bringToTop:function(){this.initialZIndex=this.cfg.getProperty("zindex"),r.superclass.bringToTop.apply(this,arguments),YAHOO.env.ua.mobile==="Apple"&&this.cfg.getProperty("zindex")==-1&&this.cfg.setProperty("zindex",2)},initEvents:function(){r.superclass.initEvents.apply(this,arguments),this.hideEvent.subscribe(function(e){t.addClass(this.element,"cow-lightbox-hidden"),this.cfg.setProperty("zindex",this.initialZIndex)})},initDefaultConfig:function(e){r.superclass.initDefaultConfig.call(this,e),this.cfg.addProperty("fillPageHeight",{value:!1,validator:n.isBoolean,handler:this.resize}),this.cfg.addProperty("sidebar",{writeOnce:!0,validator:function(e){return t.get(e)!==null},handler:function(e,r,i){var s=t.get(r[0]),o=null,u=function(){t.setStyle(s,"z-index",t.getStyle(this.element,"z-index")),t.setStyle(s,"height",this.innerElement.offsetHeight+"px"),t.setXY(s,[t.getX(this.innerElement)+this.innerElement.offsetWidth,t.getY(this.innerElement)])};this.beforeShowEvent.subscribe(function(){t.setStyle(s,"display","block"),t.setStyle(this.innerElement,"margin-right",s.offsetWidth+"px"),YAHOO.widget.Overlay.windowResizeEvent.subscribe(u,null,this),o=n.later(250,this,u,null,!0)}),this.showEvent.subscribe(u),this.beforeHideEvent.subscribe(function(){YAHOO.widget.Overlay.windowResizeEvent.unsubscribe(u),o.cancel(),t.setStyle(s,"display","none")})}})},configButtons:function(e,t,i){var s=t[0],o;for(o=0;n.isArray(s)&&o<s.length;o++)s[o].type=s[o].isDefault?"primary":"link";r.superclass.configButtons.apply(this,arguments)},configWidth:function(e,n,i){var s=this.innerElement,o=n[0];t.setStyle(s,"min-width",o),r.superclass.configWidth.apply(this,arguments)},resize:function(){var e=this.cfg.getProperty("fillPageHeight"),n=this.cfg.getProperty("visible");this.viewportWidth=t.getViewportWidth(),this.viewportHeight=t.getViewportHeight(),e||(t.setStyle([this.innerElement,this.body],"height","auto"),n&&this.fitsInViewport()&&this.center());if(e||this.element.offsetHeight>t.getViewportHeight()-30){var r=parseInt(t.getStyle(this.innerElement,"padding-top"))+parseInt(t.getStyle(this.innerElement,"padding-bottom"));this.cfg.setProperty("height",t.getViewportHeight()-30-r+"px"),this.cfg.setProperty("height",t.getViewportHeight()-30-r+"px"),n&&this.fitsInViewport()&&this.center()}this.sizeMask(),YAHOO.env.ua.ie===6&&this.sizeUnderlay()}}),ORCHESTRAL.widget.Lightbox=r}(),YAHOO.register("orchestral-lightbox",ORCHESTRAL.widget.Lightbox,{version:"7.9",build:"0"});
