/*
 * Copyright (c) Orchestral Developments Ltd (2001 - 2014).
 *
 * This document is copyright. Except for the purpose of fair reviewing, no part
 * of this publication may be reproduced or transmitted in any form or by any
 * means, electronic or mechanical, including photocopying, recording, or any
 * information storage and retrieval system, without permission in writing from
 * the publisher. Infringers of copyright render themselves liable for
 * prosecution.
 */
YUI.add("ohp-activity-status",function(e,t){"use strict";function l(){l.superclass.constructor.apply(this,arguments)}var n="ohp-message-success",r="ohp-message-failure",i=e.OHP.Locale,s=e.Lang,o=e.Template,u,a,f=new o(o.Micro);u=f.compile('<span class="<%=this.activityClass%>"><span class="throbber">&nbsp;</span></span><span class="<%=this.messageClass%>"><%=this.message%></span>'),a=f.compile('<a href="#" class="<%=this.cancelClass%>"><%=this.cancelLabel%></a>'),l.NAME="activityStatus",l.CSS_PREFIX="ohp-activity-status",l.ATTRS={cancelable:{value:!1,validator:s.isBoolean},message:{value:"",validator:s.isString},inProgress:{value:!1,validator:s.isBoolean,readOnly:!0}},l.HTML_PARSER={message:function(e){var t=e.one(this.getClassName("message"));if(t)return t.getHTML()}},e.extend(l,e.Widget,{BOUNDING_TEMPLATE:"<span></span>",CONTENT_TEMPLATE:null,initializer:function(){this._activityNode=null,this._messageNode=null,this.publish("cancel",{emitFacade:!0,defaultFn:this._defCancelFn})},renderUI:function(){var e=this.get("contentBox"),t=this.getClassName("indicator"),n=this.getClassName("message"),r={message:this.get("message"),activityClass:t,messageClass:n};e.append(u(r)),this._activityNode=e.one("."+t),this._messageNode=e.one("."+n),this.get("cancelable")&&this._activityNode.append(a({cancelLabel:i.get("widget.activityStatus.cancel"),cancelClass:this.getClassName("cancel")})),this._activityNode[this.get("inProgress")?"show":"hide"]()},bindUI:function(){var e=this.get("contentBox");this.on("messageChange",function(e){var t=this._messageNode;t&&(t.setHTML(e.newVal),t.setStyle("opacity","0"),t.transition({opacity:1}))}),this.after("inProgressChange",function(e){this._activityNode[e.newVal?"show":"hide"](e.newVal)},this),e.delegate("click",function(e){e.preventDefault(),this.cancel()},"."+this.getClassName("cancel"),this)},start:function(){this._set("inProgress",!0),this.set("message",""),this._messageNode.removeClass(n),this._messageNode.removeClass(r)},success:function(e){s.isUndefined(e)&&(e=i.get("widget.activityStatus.success")),this._set("inProgress",!1),this.set("message",e),this._messageNode.addClass(n),this._messageNode.removeClass(r)},failure:function(e){s.isUndefined(e)&&(e=i.get("widget.activityStatus.failure")),this._set("inProgress",!1),this.set("message",e),this._messageNode.addClass(r),this._messageNode.removeClass(n)},cancel:function(e){this.get("cancelable")&&this.fire("cancel",{message:e})},_defCancelFn:function(e){this.get("cancelable")&&(this._set("inProgress",!1),this.set("message",e.message||""),this._messageNode.removeClass(n),this._messageNode.removeClass(r))}}),e.namespace("OHP").ActivityStatus=l},"7.9.0",{requires:["template","ohp-locale-translations","ohp-locale-base","node-style","transition","node-event-delegate","widget","node-base"],skinnable:!0});
