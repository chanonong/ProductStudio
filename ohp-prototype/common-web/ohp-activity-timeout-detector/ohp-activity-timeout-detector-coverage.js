/*
 * Copyright (c) Orchestral Developments Ltd (2001 - 2014).
 *
 * This document is copyright. Except for the purpose of fair reviewing, no part
 * of this publication may be reproduced or transmitted in any form or by any
 * means, electronic or mechanical, including photocopying, recording, or any
 * information storage and retrieval system, without permission in writing from
 * the publisher. Infringers of copyright render themselves liable for
 * prosecution.
 */

var __cov_HuIXhFYIC7ndqfjUnNxhBQ = (Function('return this'))();
if (!__cov_HuIXhFYIC7ndqfjUnNxhBQ.__coverage__) { __cov_HuIXhFYIC7ndqfjUnNxhBQ.__coverage__ = {}; }
__cov_HuIXhFYIC7ndqfjUnNxhBQ = __cov_HuIXhFYIC7ndqfjUnNxhBQ.__coverage__;
if (!(__cov_HuIXhFYIC7ndqfjUnNxhBQ['/build/work/UIE-COW-JOB1/Common-Web/com.orchestral.commonweb/web/ohp-activity-timeout-detector/ohp-activity-timeout-detector.js'])) {
   __cov_HuIXhFYIC7ndqfjUnNxhBQ['/build/work/UIE-COW-JOB1/Common-Web/com.orchestral.commonweb/web/ohp-activity-timeout-detector/ohp-activity-timeout-detector.js'] = {"path":"/build/work/UIE-COW-JOB1/Common-Web/com.orchestral.commonweb/web/ohp-activity-timeout-detector/ohp-activity-timeout-detector.js","s":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0},"fnMap":{"1":{"name":"(anonymous_1)","line":2,"loc":{"start":{"line":2,"column":41},"end":{"line":2,"column":60}}},"2":{"name":"(anonymous_2)","line":31,"loc":{"start":{"line":31,"column":14},"end":{"line":31,"column":37}}},"3":{"name":"(anonymous_3)","line":47,"loc":{"start":{"line":47,"column":13},"end":{"line":47,"column":24}}},"4":{"name":"(anonymous_4)","line":56,"loc":{"start":{"line":56,"column":8},"end":{"line":56,"column":19}}},"5":{"name":"(anonymous_5)","line":75,"loc":{"start":{"line":75,"column":14},"end":{"line":75,"column":25}}},"6":{"name":"(anonymous_6)","line":79,"loc":{"start":{"line":79,"column":24},"end":{"line":79,"column":35}}},"7":{"name":"(anonymous_7)","line":84,"loc":{"start":{"line":84,"column":15},"end":{"line":84,"column":26}}},"8":{"name":"(anonymous_8)","line":92,"loc":{"start":{"line":92,"column":16},"end":{"line":92,"column":27}}},"9":{"name":"(anonymous_9)","line":97,"loc":{"start":{"line":97,"column":22},"end":{"line":97,"column":33}}},"10":{"name":"(anonymous_10)","line":104,"loc":{"start":{"line":104,"column":24},"end":{"line":104,"column":35}}},"11":{"name":"(anonymous_11)","line":113,"loc":{"start":{"line":113,"column":26},"end":{"line":113,"column":37}}},"12":{"name":"(anonymous_12)","line":141,"loc":{"start":{"line":141,"column":7},"end":{"line":141,"column":18}}}},"statementMap":{"1":{"start":{"line":2,"column":0},"end":{"line":183,"column":3}},"2":{"start":{"line":11,"column":0},"end":{"line":17,"column":43}},"3":{"start":{"line":19,"column":0},"end":{"line":21,"column":3}},"4":{"start":{"line":30,"column":0},"end":{"line":166,"column":3}},"5":{"start":{"line":32,"column":2},"end":{"line":32,"column":32}},"6":{"start":{"line":33,"column":2},"end":{"line":33,"column":40}},"7":{"start":{"line":34,"column":2},"end":{"line":34,"column":32}},"8":{"start":{"line":42,"column":2},"end":{"line":44,"column":5}},"9":{"start":{"line":48,"column":2},"end":{"line":48,"column":14}},"10":{"start":{"line":57,"column":2},"end":{"line":59,"column":3}},"11":{"start":{"line":58,"column":3},"end":{"line":58,"column":10}},"12":{"start":{"line":61,"column":2},"end":{"line":65,"column":4}},"13":{"start":{"line":67,"column":2},"end":{"line":67,"column":78}},"14":{"start":{"line":69,"column":2},"end":{"line":69,"column":66}},"15":{"start":{"line":71,"column":2},"end":{"line":71,"column":21}},"16":{"start":{"line":72,"column":2},"end":{"line":72,"column":31}},"17":{"start":{"line":76,"column":2},"end":{"line":76,"column":94}},"18":{"start":{"line":80,"column":2},"end":{"line":80,"column":39}},"19":{"start":{"line":81,"column":2},"end":{"line":81,"column":49}},"20":{"start":{"line":85,"column":2},"end":{"line":85,"column":40}},"21":{"start":{"line":87,"column":2},"end":{"line":89,"column":3}},"22":{"start":{"line":88,"column":3},"end":{"line":88,"column":39}},"23":{"start":{"line":93,"column":2},"end":{"line":93,"column":22}},"24":{"start":{"line":94,"column":2},"end":{"line":94,"column":21}},"25":{"start":{"line":99,"column":2},"end":{"line":101,"column":3}},"26":{"start":{"line":100,"column":3},"end":{"line":100,"column":24}},"27":{"start":{"line":105,"column":2},"end":{"line":108,"column":3}},"28":{"start":{"line":107,"column":3},"end":{"line":107,"column":10}},"29":{"start":{"line":110,"column":2},"end":{"line":110,"column":23}},"30":{"start":{"line":115,"column":2},"end":{"line":118,"column":23}},"31":{"start":{"line":120,"column":2},"end":{"line":123,"column":3}},"32":{"start":{"line":121,"column":3},"end":{"line":121,"column":56}},"33":{"start":{"line":122,"column":3},"end":{"line":122,"column":10}},"34":{"start":{"line":125,"column":2},"end":{"line":125,"column":66}},"35":{"start":{"line":127,"column":2},"end":{"line":133,"column":3}},"36":{"start":{"line":129,"column":3},"end":{"line":129,"column":56}},"37":{"start":{"line":130,"column":9},"end":{"line":133,"column":3}},"38":{"start":{"line":132,"column":3},"end":{"line":132,"column":50}},"39":{"start":{"line":142,"column":2},"end":{"line":142,"column":22}},"40":{"start":{"line":144,"column":2},"end":{"line":144,"column":53}},"41":{"start":{"line":146,"column":2},"end":{"line":148,"column":3}},"42":{"start":{"line":147,"column":3},"end":{"line":147,"column":67}},"43":{"start":{"line":150,"column":2},"end":{"line":150,"column":32}},"44":{"start":{"line":168,"column":0},"end":{"line":168,"column":55}}},"branchMap":{"1":{"line":57,"type":"if","locations":[{"start":{"line":57,"column":2},"end":{"line":57,"column":2}},{"start":{"line":57,"column":2},"end":{"line":57,"column":2}}]},"2":{"line":87,"type":"if","locations":[{"start":{"line":87,"column":2},"end":{"line":87,"column":2}},{"start":{"line":87,"column":2},"end":{"line":87,"column":2}}]},"3":{"line":99,"type":"if","locations":[{"start":{"line":99,"column":2},"end":{"line":99,"column":2}},{"start":{"line":99,"column":2},"end":{"line":99,"column":2}}]},"4":{"line":105,"type":"if","locations":[{"start":{"line":105,"column":2},"end":{"line":105,"column":2}},{"start":{"line":105,"column":2},"end":{"line":105,"column":2}}]},"5":{"line":120,"type":"if","locations":[{"start":{"line":120,"column":2},"end":{"line":120,"column":2}},{"start":{"line":120,"column":2},"end":{"line":120,"column":2}}]},"6":{"line":127,"type":"if","locations":[{"start":{"line":127,"column":2},"end":{"line":127,"column":2}},{"start":{"line":127,"column":2},"end":{"line":127,"column":2}}]},"7":{"line":130,"type":"if","locations":[{"start":{"line":130,"column":9},"end":{"line":130,"column":9}},{"start":{"line":130,"column":9},"end":{"line":130,"column":9}}]},"8":{"line":146,"type":"if","locations":[{"start":{"line":146,"column":2},"end":{"line":146,"column":2}},{"start":{"line":146,"column":2},"end":{"line":146,"column":2}}]}},"code":["(function () { /*!(C) ORCHESTRAL*/","YUI.add('ohp-activity-timeout-detector', function (Y, NAME) {","","\"use strict\";","/**","Activity timeout detector. It listens to activity events fired from activity tracker, and fires timeout events","when configured timeout is reached.","","@module ohp-activity-timeout-detector","**/","var Detector,","\twin = Y.config.win,","\tdoc = Y.config.doc,","","\tactivitySyncer = new Y.COW.ActivitySyncer(YUI.OHP.ActivityTracker.ACTIVITY_STORAGE_KEY),","","\tDEFAULT_ACTIVITY_TIMEOUT = 10 * 60 * 1000; // 10 minutes","","Y.mix(Y.Node.DOM_EVENTS, {","\tvisibilitychange: true","});","","/**","The activity timeout detector class.","","@class Detector","@namespace OHP.ActivityTimeout","@extends Base","**/","Detector = Y.Base.create('ohp-activity-timeout-detector', Y.Base, [], {","\tinitializer: function( /*config*/ ) {","\t\tthis._detectorStarted = false;","\t\tthis._activityTimeoutOccurred = false;","\t\tthis._eventSubscriptions = [];","","\t\t/**","\t\tThis event is fired when no activity is detected during the period of timeout time.","\t\tThis event is broadcasted to Y and Y.Global.","","\t\t@event ohp-activity-timeout:activityTimeout","\t\t**/","\t\tY.publish('ohp-activity-timeout:activityTimeout', {","\t\t\tbroadcast: 2","\t\t});","\t},","","\tdestructor: function() {","\t\tthis.stop();","\t},","","\t/**","\tStart the timeout detection.","","\t@method start","\t**/","\tstart: function() {","\t\tif (this._detectorStarted) {","\t\t\treturn;","\t\t}","","\t\tthis._eventSubscriptions.push(","\t\t\tY.Global.on('ohp-activity-tracker:activityDetected', this._onActivityDetected, this),","\t\t\tY.Global.on('ohp-activity-timeout:warningDismissed', this._restartTimer, this),","\t\t\tY.one(doc).on('visibilitychange', this._onPageVisibilityChange, this)","\t\t);","","\t\tthis._storageChangeEventListener = Y.bind(this._onLocalStorageChange, this);","","\t\tactivitySyncer.attachListener(this._storageChangeEventListener);","","\t\tthis._startTimer();","\t\tthis._detectorStarted = true;","\t},","","\t_startTimer: function() {","\t\tthis._activityTimeoutTimer = Y.later(this.get('timeout'), this, this._onTimeoutTimerExpiry);","\t},","","\t_onTimeoutTimerExpiry: function() {","\t\tthis._activityTimeoutOccurred = true;","\t\tY.fire('ohp-activity-timeout:activityTimeout');","\t},","","\t_cancelTimer: function() {","\t\tthis._activityTimeoutOccurred = false;","","\t\tif (this._activityTimeoutTimer) {","\t\t\tthis._activityTimeoutTimer.cancel();","\t\t}","\t},","","\t_restartTimer: function() {","\t\tthis._cancelTimer();","\t\tthis._startTimer();","\t},","","\t_onActivityDetected: function() {","\t\t// Ignore activity detected if a timeout has already occurred (i.e. the warning panel is displayed)","\t\tif (!this._activityTimeoutOccurred) {","\t\t\tthis._restartTimer();","\t\t}","\t},","","\t_onLocalStorageChange: function() {","\t\tif (this._activityTimeoutOccurred) {","\t\t\t// Ignore activity detected if a timeout has already occurred (i.e. the warning panel is displayed)","\t\t\treturn;","\t\t}","","\t\tthis._restartTimer();","\t},","","\t_onPageVisibilityChange: function() {","\t\t// Get the current time and last activity time","\t\tvar currentTimestamp = Y.Lang.now(),","\t\t\tactivityData = activitySyncer.get(),","\t\t\ttimeout = this.get('timeout'),","\t\t\ttimestampDifference;","","\t\tif (!activityData) {","\t\t\tY.Global.fire('ohp-activity-timeout:warningTimeout');","\t\t\treturn;","\t\t}","","\t\ttimestampDifference = currentTimestamp - activityData.timestamp;","","\t\tif (timestampDifference >= timeout + Y.OHP.ActivityTimeout.WarningPanel._WARNING_COUNT_DOWN_TIME) {","\t\t\t// The last activity occurred more than the timeout plus the countdown, fire logout event","\t\t\tY.Global.fire('ohp-activity-timeout:warningTimeout');","\t\t} else if (timestampDifference > timeout + 1000) {","\t\t\t// The last activity occurred more than the timeout plus 1 second fire the show warning event","\t\t\tY.fire('ohp-activity-timeout:activityTimeout');","\t\t}","\t},","","\t/**","\tStop the timeout detection.","","\t@method stop","\t**/","\tstop: function() {","\t\tthis._cancelTimer();","","\t\tY.Array.invoke(this._eventSubscriptions, 'detach');","","\t\tif (this._storageChangeEventListener) {","\t\t\tactivitySyncer.detachListener(this._storageChangeEventListener);","\t\t}","","\t\tthis._detectorStarted = false;","\t}","}, {","\tATTRS: {","\t\t/**","\t\tTimeout period if there is no activity detected.","","\t\t@config timeout","\t\t@default 600000 milliseconds(10 mins)","\t\t@type Number","\t\t**/","\t\ttimeout: {","\t\t\tvalue: DEFAULT_ACTIVITY_TIMEOUT,","\t\t\twriteOnce: 'initOnly'","\t\t}","\t}","});","","Y.namespace('OHP.ActivityTimeout').Detector = Detector;","","","}, '7.9.0', {","    \"requires\": [","        \"base\",","        \"node-base\",","        \"event-base\",","        \"event-custom\",","        \"yui-later\",","        \"array-invoke\",","        \"ohp-activity-tracker\",","        \"json-parse\",","        \"cow-activity-syncer\"","    ]","});","","}());"]};
}
__cov_HuIXhFYIC7ndqfjUnNxhBQ = __cov_HuIXhFYIC7ndqfjUnNxhBQ['/build/work/UIE-COW-JOB1/Common-Web/com.orchestral.commonweb/web/ohp-activity-timeout-detector/ohp-activity-timeout-detector.js'];
__cov_HuIXhFYIC7ndqfjUnNxhBQ.s['1']++;YUI.add('ohp-activity-timeout-detector',function(Y,NAME){'use strict';__cov_HuIXhFYIC7ndqfjUnNxhBQ.f['1']++;__cov_HuIXhFYIC7ndqfjUnNxhBQ.s['2']++;var Detector,win=Y.config.win,doc=Y.config.doc,activitySyncer=new Y.COW.ActivitySyncer(YUI.OHP.ActivityTracker.ACTIVITY_STORAGE_KEY),DEFAULT_ACTIVITY_TIMEOUT=10*60*1000;__cov_HuIXhFYIC7ndqfjUnNxhBQ.s['3']++;Y.mix(Y.Node.DOM_EVENTS,{visibilitychange:true});__cov_HuIXhFYIC7ndqfjUnNxhBQ.s['4']++;Detector=Y.Base.create('ohp-activity-timeout-detector',Y.Base,[],{initializer:function(){__cov_HuIXhFYIC7ndqfjUnNxhBQ.f['2']++;__cov_HuIXhFYIC7ndqfjUnNxhBQ.s['5']++;this._detectorStarted=false;__cov_HuIXhFYIC7ndqfjUnNxhBQ.s['6']++;this._activityTimeoutOccurred=false;__cov_HuIXhFYIC7ndqfjUnNxhBQ.s['7']++;this._eventSubscriptions=[];__cov_HuIXhFYIC7ndqfjUnNxhBQ.s['8']++;Y.publish('ohp-activity-timeout:activityTimeout',{broadcast:2});},destructor:function(){__cov_HuIXhFYIC7ndqfjUnNxhBQ.f['3']++;__cov_HuIXhFYIC7ndqfjUnNxhBQ.s['9']++;this.stop();},start:function(){__cov_HuIXhFYIC7ndqfjUnNxhBQ.f['4']++;__cov_HuIXhFYIC7ndqfjUnNxhBQ.s['10']++;if(this._detectorStarted){__cov_HuIXhFYIC7ndqfjUnNxhBQ.b['1'][0]++;__cov_HuIXhFYIC7ndqfjUnNxhBQ.s['11']++;return;}else{__cov_HuIXhFYIC7ndqfjUnNxhBQ.b['1'][1]++;}__cov_HuIXhFYIC7ndqfjUnNxhBQ.s['12']++;this._eventSubscriptions.push(Y.Global.on('ohp-activity-tracker:activityDetected',this._onActivityDetected,this),Y.Global.on('ohp-activity-timeout:warningDismissed',this._restartTimer,this),Y.one(doc).on('visibilitychange',this._onPageVisibilityChange,this));__cov_HuIXhFYIC7ndqfjUnNxhBQ.s['13']++;this._storageChangeEventListener=Y.bind(this._onLocalStorageChange,this);__cov_HuIXhFYIC7ndqfjUnNxhBQ.s['14']++;activitySyncer.attachListener(this._storageChangeEventListener);__cov_HuIXhFYIC7ndqfjUnNxhBQ.s['15']++;this._startTimer();__cov_HuIXhFYIC7ndqfjUnNxhBQ.s['16']++;this._detectorStarted=true;},_startTimer:function(){__cov_HuIXhFYIC7ndqfjUnNxhBQ.f['5']++;__cov_HuIXhFYIC7ndqfjUnNxhBQ.s['17']++;this._activityTimeoutTimer=Y.later(this.get('timeout'),this,this._onTimeoutTimerExpiry);},_onTimeoutTimerExpiry:function(){__cov_HuIXhFYIC7ndqfjUnNxhBQ.f['6']++;__cov_HuIXhFYIC7ndqfjUnNxhBQ.s['18']++;this._activityTimeoutOccurred=true;__cov_HuIXhFYIC7ndqfjUnNxhBQ.s['19']++;Y.fire('ohp-activity-timeout:activityTimeout');},_cancelTimer:function(){__cov_HuIXhFYIC7ndqfjUnNxhBQ.f['7']++;__cov_HuIXhFYIC7ndqfjUnNxhBQ.s['20']++;this._activityTimeoutOccurred=false;__cov_HuIXhFYIC7ndqfjUnNxhBQ.s['21']++;if(this._activityTimeoutTimer){__cov_HuIXhFYIC7ndqfjUnNxhBQ.b['2'][0]++;__cov_HuIXhFYIC7ndqfjUnNxhBQ.s['22']++;this._activityTimeoutTimer.cancel();}else{__cov_HuIXhFYIC7ndqfjUnNxhBQ.b['2'][1]++;}},_restartTimer:function(){__cov_HuIXhFYIC7ndqfjUnNxhBQ.f['8']++;__cov_HuIXhFYIC7ndqfjUnNxhBQ.s['23']++;this._cancelTimer();__cov_HuIXhFYIC7ndqfjUnNxhBQ.s['24']++;this._startTimer();},_onActivityDetected:function(){__cov_HuIXhFYIC7ndqfjUnNxhBQ.f['9']++;__cov_HuIXhFYIC7ndqfjUnNxhBQ.s['25']++;if(!this._activityTimeoutOccurred){__cov_HuIXhFYIC7ndqfjUnNxhBQ.b['3'][0]++;__cov_HuIXhFYIC7ndqfjUnNxhBQ.s['26']++;this._restartTimer();}else{__cov_HuIXhFYIC7ndqfjUnNxhBQ.b['3'][1]++;}},_onLocalStorageChange:function(){__cov_HuIXhFYIC7ndqfjUnNxhBQ.f['10']++;__cov_HuIXhFYIC7ndqfjUnNxhBQ.s['27']++;if(this._activityTimeoutOccurred){__cov_HuIXhFYIC7ndqfjUnNxhBQ.b['4'][0]++;__cov_HuIXhFYIC7ndqfjUnNxhBQ.s['28']++;return;}else{__cov_HuIXhFYIC7ndqfjUnNxhBQ.b['4'][1]++;}__cov_HuIXhFYIC7ndqfjUnNxhBQ.s['29']++;this._restartTimer();},_onPageVisibilityChange:function(){__cov_HuIXhFYIC7ndqfjUnNxhBQ.f['11']++;__cov_HuIXhFYIC7ndqfjUnNxhBQ.s['30']++;var currentTimestamp=Y.Lang.now(),activityData=activitySyncer.get(),timeout=this.get('timeout'),timestampDifference;__cov_HuIXhFYIC7ndqfjUnNxhBQ.s['31']++;if(!activityData){__cov_HuIXhFYIC7ndqfjUnNxhBQ.b['5'][0]++;__cov_HuIXhFYIC7ndqfjUnNxhBQ.s['32']++;Y.Global.fire('ohp-activity-timeout:warningTimeout');__cov_HuIXhFYIC7ndqfjUnNxhBQ.s['33']++;return;}else{__cov_HuIXhFYIC7ndqfjUnNxhBQ.b['5'][1]++;}__cov_HuIXhFYIC7ndqfjUnNxhBQ.s['34']++;timestampDifference=currentTimestamp-activityData.timestamp;__cov_HuIXhFYIC7ndqfjUnNxhBQ.s['35']++;if(timestampDifference>=timeout+Y.OHP.ActivityTimeout.WarningPanel._WARNING_COUNT_DOWN_TIME){__cov_HuIXhFYIC7ndqfjUnNxhBQ.b['6'][0]++;__cov_HuIXhFYIC7ndqfjUnNxhBQ.s['36']++;Y.Global.fire('ohp-activity-timeout:warningTimeout');}else{__cov_HuIXhFYIC7ndqfjUnNxhBQ.b['6'][1]++;__cov_HuIXhFYIC7ndqfjUnNxhBQ.s['37']++;if(timestampDifference>timeout+1000){__cov_HuIXhFYIC7ndqfjUnNxhBQ.b['7'][0]++;__cov_HuIXhFYIC7ndqfjUnNxhBQ.s['38']++;Y.fire('ohp-activity-timeout:activityTimeout');}else{__cov_HuIXhFYIC7ndqfjUnNxhBQ.b['7'][1]++;}}},stop:function(){__cov_HuIXhFYIC7ndqfjUnNxhBQ.f['12']++;__cov_HuIXhFYIC7ndqfjUnNxhBQ.s['39']++;this._cancelTimer();__cov_HuIXhFYIC7ndqfjUnNxhBQ.s['40']++;Y.Array.invoke(this._eventSubscriptions,'detach');__cov_HuIXhFYIC7ndqfjUnNxhBQ.s['41']++;if(this._storageChangeEventListener){__cov_HuIXhFYIC7ndqfjUnNxhBQ.b['8'][0]++;__cov_HuIXhFYIC7ndqfjUnNxhBQ.s['42']++;activitySyncer.detachListener(this._storageChangeEventListener);}else{__cov_HuIXhFYIC7ndqfjUnNxhBQ.b['8'][1]++;}__cov_HuIXhFYIC7ndqfjUnNxhBQ.s['43']++;this._detectorStarted=false;}},{ATTRS:{timeout:{value:DEFAULT_ACTIVITY_TIMEOUT,writeOnce:'initOnly'}}});__cov_HuIXhFYIC7ndqfjUnNxhBQ.s['44']++;Y.namespace('OHP.ActivityTimeout').Detector=Detector;},'7.9.0',{'requires':['base','node-base','event-base','event-custom','yui-later','array-invoke','ohp-activity-tracker','json-parse','cow-activity-syncer']});
