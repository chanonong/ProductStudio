/*
 * Copyright (c) Orchestral Developments Ltd (2001 - 2014).
 *
 * This document is copyright. Except for the purpose of fair reviewing, no part
 * of this publication may be reproduced or transmitted in any form or by any
 * means, electronic or mechanical, including photocopying, recording, or any
 * information storage and retrieval system, without permission in writing from
 * the publisher. Infringers of copyright render themselves liable for
 * prosecution.
 */

var __cov_ELdXZxPupLJwxf7gY0ONxQ = (Function('return this'))();
if (!__cov_ELdXZxPupLJwxf7gY0ONxQ.__coverage__) { __cov_ELdXZxPupLJwxf7gY0ONxQ.__coverage__ = {}; }
__cov_ELdXZxPupLJwxf7gY0ONxQ = __cov_ELdXZxPupLJwxf7gY0ONxQ.__coverage__;
if (!(__cov_ELdXZxPupLJwxf7gY0ONxQ['/build/work/UIE-COW-JOB1/Common-Web/com.orchestral.commonweb/web/ohp-activity-timeout/ohp-activity-timeout.js'])) {
   __cov_ELdXZxPupLJwxf7gY0ONxQ['/build/work/UIE-COW-JOB1/Common-Web/com.orchestral.commonweb/web/ohp-activity-timeout/ohp-activity-timeout.js'] = {"path":"/build/work/UIE-COW-JOB1/Common-Web/com.orchestral.commonweb/web/ohp-activity-timeout/ohp-activity-timeout.js","s":{"1":0,"2":0,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0},"fnMap":{"1":{"name":"(anonymous_1)","line":2,"loc":{"start":{"line":2,"column":32},"end":{"line":2,"column":51}}},"2":{"name":"getInstanceOnAncestorFrame","line":29,"loc":{"start":{"line":29,"column":0},"end":{"line":29,"column":51}}},"3":{"name":"(anonymous_3)","line":59,"loc":{"start":{"line":59,"column":14},"end":{"line":59,"column":37}}},"4":{"name":"(anonymous_4)","line":88,"loc":{"start":{"line":88,"column":13},"end":{"line":88,"column":24}}},"5":{"name":"(anonymous_5)","line":116,"loc":{"start":{"line":116,"column":20},"end":{"line":116,"column":37}}},"6":{"name":"(anonymous_6)","line":126,"loc":{"start":{"line":126,"column":43},"end":{"line":126,"column":54}}},"7":{"name":"(anonymous_7)","line":146,"loc":{"start":{"line":146,"column":28},"end":{"line":146,"column":39}}},"8":{"name":"(anonymous_8)","line":153,"loc":{"start":{"line":153,"column":25},"end":{"line":153,"column":36}}},"9":{"name":"(anonymous_9)","line":173,"loc":{"start":{"line":173,"column":24},"end":{"line":173,"column":35}}},"10":{"name":"(anonymous_10)","line":177,"loc":{"start":{"line":177,"column":37},"end":{"line":177,"column":48}}},"11":{"name":"(anonymous_11)","line":182,"loc":{"start":{"line":182,"column":34},"end":{"line":182,"column":45}}},"12":{"name":"(anonymous_12)","line":187,"loc":{"start":{"line":187,"column":40},"end":{"line":187,"column":51}}},"13":{"name":"(anonymous_13)","line":191,"loc":{"start":{"line":191,"column":30},"end":{"line":191,"column":46}}},"14":{"name":"(anonymous_14)","line":205,"loc":{"start":{"line":205,"column":18},"end":{"line":205,"column":35}}},"15":{"name":"(anonymous_15)","line":214,"loc":{"start":{"line":214,"column":22},"end":{"line":214,"column":33}}},"16":{"name":"(anonymous_16)","line":218,"loc":{"start":{"line":218,"column":17},"end":{"line":218,"column":28}}},"17":{"name":"(anonymous_17)","line":229,"loc":{"start":{"line":229,"column":24},"end":{"line":229,"column":35}}},"18":{"name":"(anonymous_18)","line":235,"loc":{"start":{"line":235,"column":26},"end":{"line":235,"column":37}}}},"statementMap":{"1":{"start":{"line":2,"column":0},"end":{"line":316,"column":3}},"2":{"start":{"line":10,"column":0},"end":{"line":27,"column":24}},"3":{"start":{"line":29,"column":0},"end":{"line":46,"column":1}},"4":{"start":{"line":30,"column":1},"end":{"line":32,"column":17}},"5":{"start":{"line":34,"column":1},"end":{"line":36,"column":2}},"6":{"start":{"line":35,"column":2},"end":{"line":35,"column":14}},"7":{"start":{"line":38,"column":1},"end":{"line":43,"column":2}},"8":{"start":{"line":39,"column":2},"end":{"line":39,"column":69}},"9":{"start":{"line":40,"column":2},"end":{"line":42,"column":3}},"10":{"start":{"line":41,"column":3},"end":{"line":41,"column":35}},"11":{"start":{"line":45,"column":1},"end":{"line":45,"column":49}},"12":{"start":{"line":48,"column":0},"end":{"line":48,"column":54}},"13":{"start":{"line":58,"column":0},"end":{"line":293,"column":3}},"14":{"start":{"line":60,"column":2},"end":{"line":60,"column":32}},"15":{"start":{"line":68,"column":2},"end":{"line":70,"column":5}},"16":{"start":{"line":78,"column":2},"end":{"line":80,"column":5}},"17":{"start":{"line":83,"column":2},"end":{"line":83,"column":28}},"18":{"start":{"line":85,"column":2},"end":{"line":85,"column":29}},"19":{"start":{"line":89,"column":2},"end":{"line":89,"column":33}},"20":{"start":{"line":91,"column":2},"end":{"line":93,"column":3}},"21":{"start":{"line":92,"column":3},"end":{"line":92,"column":43}},"22":{"start":{"line":94,"column":2},"end":{"line":96,"column":3}},"23":{"start":{"line":95,"column":3},"end":{"line":95,"column":47}},"24":{"start":{"line":98,"column":2},"end":{"line":100,"column":3}},"25":{"start":{"line":99,"column":3},"end":{"line":99,"column":67}},"26":{"start":{"line":117,"column":2},"end":{"line":119,"column":3}},"27":{"start":{"line":118,"column":3},"end":{"line":118,"column":16}},"28":{"start":{"line":121,"column":2},"end":{"line":123,"column":5}},"29":{"start":{"line":124,"column":2},"end":{"line":124,"column":79}},"30":{"start":{"line":126,"column":2},"end":{"line":126,"column":58}},"31":{"start":{"line":128,"column":2},"end":{"line":130,"column":3}},"32":{"start":{"line":129,"column":3},"end":{"line":129,"column":40}},"33":{"start":{"line":131,"column":2},"end":{"line":133,"column":3}},"34":{"start":{"line":132,"column":3},"end":{"line":132,"column":50}},"35":{"start":{"line":135,"column":2},"end":{"line":135,"column":32}},"36":{"start":{"line":137,"column":2},"end":{"line":137,"column":14}},"37":{"start":{"line":147,"column":2},"end":{"line":149,"column":3}},"38":{"start":{"line":148,"column":3},"end":{"line":148,"column":61}},"39":{"start":{"line":150,"column":2},"end":{"line":150,"column":45}},"40":{"start":{"line":154,"column":2},"end":{"line":154,"column":40}},"41":{"start":{"line":155,"column":2},"end":{"line":155,"column":45}},"42":{"start":{"line":157,"column":2},"end":{"line":159,"column":3}},"43":{"start":{"line":158,"column":3},"end":{"line":158,"column":104}},"44":{"start":{"line":161,"column":2},"end":{"line":165,"column":4}},"45":{"start":{"line":167,"column":2},"end":{"line":167,"column":84}},"46":{"start":{"line":168,"column":2},"end":{"line":168,"column":66}},"47":{"start":{"line":170,"column":2},"end":{"line":170,"column":38}},"48":{"start":{"line":174,"column":2},"end":{"line":174,"column":41}},"49":{"start":{"line":178,"column":2},"end":{"line":178,"column":47}},"50":{"start":{"line":179,"column":2},"end":{"line":179,"column":43}},"51":{"start":{"line":183,"column":2},"end":{"line":183,"column":47}},"52":{"start":{"line":184,"column":2},"end":{"line":184,"column":24}},"53":{"start":{"line":188,"column":2},"end":{"line":188,"column":49}},"54":{"start":{"line":192,"column":2},"end":{"line":192,"column":27}},"55":{"start":{"line":194,"column":2},"end":{"line":202,"column":3}},"56":{"start":{"line":195,"column":3},"end":{"line":195,"column":50}},"57":{"start":{"line":196,"column":9},"end":{"line":202,"column":3}},"58":{"start":{"line":197,"column":3},"end":{"line":197,"column":47}},"59":{"start":{"line":200,"column":9},"end":{"line":202,"column":3}},"60":{"start":{"line":201,"column":3},"end":{"line":201,"column":49}},"61":{"start":{"line":206,"column":2},"end":{"line":206,"column":43}},"62":{"start":{"line":207,"column":2},"end":{"line":211,"column":3}},"63":{"start":{"line":208,"column":3},"end":{"line":208,"column":36}},"64":{"start":{"line":210,"column":3},"end":{"line":210,"column":49}},"65":{"start":{"line":215,"column":2},"end":{"line":215,"column":25}},"66":{"start":{"line":219,"column":2},"end":{"line":222,"column":3}},"67":{"start":{"line":221,"column":3},"end":{"line":221,"column":10}},"68":{"start":{"line":224,"column":2},"end":{"line":224,"column":45}},"69":{"start":{"line":225,"column":2},"end":{"line":225,"column":31}},"70":{"start":{"line":226,"column":2},"end":{"line":226,"column":25}},"71":{"start":{"line":230,"column":2},"end":{"line":232,"column":3}},"72":{"start":{"line":231,"column":3},"end":{"line":231,"column":33}},"73":{"start":{"line":236,"column":2},"end":{"line":236,"column":53}},"74":{"start":{"line":238,"column":2},"end":{"line":238,"column":39}},"75":{"start":{"line":239,"column":2},"end":{"line":239,"column":43}},"76":{"start":{"line":240,"column":2},"end":{"line":240,"column":31}},"77":{"start":{"line":241,"column":2},"end":{"line":241,"column":39}},"78":{"start":{"line":295,"column":0},"end":{"line":297,"column":1}},"79":{"start":{"line":296,"column":1},"end":{"line":296,"column":55}},"80":{"start":{"line":299,"column":0},"end":{"line":299,"column":110}}},"branchMap":{"1":{"line":30,"type":"binary-expr","locations":[{"start":{"line":30,"column":12},"end":{"line":30,"column":25}},{"start":{"line":30,"column":29},"end":{"line":30,"column":32}}]},"2":{"line":34,"type":"if","locations":[{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},{"start":{"line":34,"column":1},"end":{"line":34,"column":1}}]},"3":{"line":38,"type":"if","locations":[{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},{"start":{"line":38,"column":1},"end":{"line":38,"column":1}}]},"4":{"line":40,"type":"if","locations":[{"start":{"line":40,"column":2},"end":{"line":40,"column":2}},{"start":{"line":40,"column":2},"end":{"line":40,"column":2}}]},"5":{"line":91,"type":"if","locations":[{"start":{"line":91,"column":2},"end":{"line":91,"column":2}},{"start":{"line":91,"column":2},"end":{"line":91,"column":2}}]},"6":{"line":94,"type":"if","locations":[{"start":{"line":94,"column":2},"end":{"line":94,"column":2}},{"start":{"line":94,"column":2},"end":{"line":94,"column":2}}]},"7":{"line":98,"type":"if","locations":[{"start":{"line":98,"column":2},"end":{"line":98,"column":2}},{"start":{"line":98,"column":2},"end":{"line":98,"column":2}}]},"8":{"line":117,"type":"if","locations":[{"start":{"line":117,"column":2},"end":{"line":117,"column":2}},{"start":{"line":117,"column":2},"end":{"line":117,"column":2}}]},"9":{"line":117,"type":"binary-expr","locations":[{"start":{"line":117,"column":6},"end":{"line":117,"column":34}},{"start":{"line":117,"column":38},"end":{"line":117,"column":60}}]},"10":{"line":126,"type":"binary-expr","locations":[{"start":{"line":126,"column":24},"end":{"line":126,"column":39}},{"start":{"line":126,"column":43},"end":{"line":126,"column":56}}]},"11":{"line":128,"type":"if","locations":[{"start":{"line":128,"column":2},"end":{"line":128,"column":2}},{"start":{"line":128,"column":2},"end":{"line":128,"column":2}}]},"12":{"line":131,"type":"if","locations":[{"start":{"line":131,"column":2},"end":{"line":131,"column":2}},{"start":{"line":131,"column":2},"end":{"line":131,"column":2}}]},"13":{"line":147,"type":"if","locations":[{"start":{"line":147,"column":2},"end":{"line":147,"column":2}},{"start":{"line":147,"column":2},"end":{"line":147,"column":2}}]},"14":{"line":157,"type":"if","locations":[{"start":{"line":157,"column":2},"end":{"line":157,"column":2}},{"start":{"line":157,"column":2},"end":{"line":157,"column":2}}]},"15":{"line":194,"type":"if","locations":[{"start":{"line":194,"column":2},"end":{"line":194,"column":2}},{"start":{"line":194,"column":2},"end":{"line":194,"column":2}}]},"16":{"line":196,"type":"if","locations":[{"start":{"line":196,"column":9},"end":{"line":196,"column":9}},{"start":{"line":196,"column":9},"end":{"line":196,"column":9}}]},"17":{"line":200,"type":"if","locations":[{"start":{"line":200,"column":9},"end":{"line":200,"column":9}},{"start":{"line":200,"column":9},"end":{"line":200,"column":9}}]},"18":{"line":200,"type":"binary-expr","locations":[{"start":{"line":200,"column":13},"end":{"line":200,"column":46}},{"start":{"line":200,"column":50},"end":{"line":200,"column":86}}]},"19":{"line":207,"type":"if","locations":[{"start":{"line":207,"column":2},"end":{"line":207,"column":2}},{"start":{"line":207,"column":2},"end":{"line":207,"column":2}}]},"20":{"line":219,"type":"if","locations":[{"start":{"line":219,"column":2},"end":{"line":219,"column":2}},{"start":{"line":219,"column":2},"end":{"line":219,"column":2}}]},"21":{"line":230,"type":"if","locations":[{"start":{"line":230,"column":2},"end":{"line":230,"column":2}},{"start":{"line":230,"column":2},"end":{"line":230,"column":2}}]},"22":{"line":295,"type":"if","locations":[{"start":{"line":295,"column":0},"end":{"line":295,"column":0}},{"start":{"line":295,"column":0},"end":{"line":295,"column":0}}]}},"code":["(function () { /*!(C) ORCHESTRAL*/","YUI.add('ohp-activity-timeout', function (Y, NAME) {","","\"use strict\";","/**","Activity timeout module. It wires up all the submodules to provide automatic logout functionality.","","@module ohp-activity-timeout","**/","var Lang = Y.Lang,","\twin = Y.config.win,","\tdoc = Y.config.doc,","","\tACTIVITY_TIMEOUT_ACTION_STORAGE_KEY = 'ohp-activity-timeout-action',","\tactivitySyncer = new Y.COW.ActivitySyncer(ACTIVITY_TIMEOUT_ACTION_STORAGE_KEY),","","\tDEFAULT_PING_INTERVAL = 60 * 1000, // 1 minute","","\tACTION_DISPLAY_WARNING = 'displayWarning',","\tACTION_WARNING_DISMISSED = 'warningDismissed',","\tACTION_WARNING_TIMEOUT = 'warningTimeout',","","\tGLOBAL_SINGLETON_NS = YUI.namespace('OHP.ActivityTimeout'),","","\tActivityTimeout,","","\t_ancestorFrameInstance;","","function getInstanceOnAncestorFrame(currentWindow) {","\tvar curr = currentWindow || win,","\t\tparentWindow = curr.parent,","\t\tparentWindowNS;","","\tif (curr === curr.top) {","\t\treturn null;","\t}","","\tif (!Lang.isUndefined(parentWindow.YUI)) {","\t\tparentWindowNS = parentWindow.YUI.namespace('OHP.ActivityTimeout');","\t\tif (parentWindowNS._instance) {","\t\t\treturn parentWindowNS._instance;","\t\t}","\t}","","\treturn getInstanceOnAncestorFrame(parentWindow);","}","","_ancestorFrameInstance = getInstanceOnAncestorFrame();","","/**","The activity timeout class.","","@class ActivityTimeout","@static","@namespace OHP","@extends Base","**/","ActivityTimeout = Y.Base.create('ohp-activity-timeout', Y.Base, [], {","\tinitializer: function( /*config*/ ) {","\t\tthis._eventSubscriptions = [];","","\t\t/**","\t\tThis event is fired when no activity is detected during the period of timeout time.","\t\tThis event is broadcasted to Y and Y.Global.","","\t\t@event ohp-activity-timeout:activityTimeout","\t\t**/","\t\tY.publish('ohp-activity-timeout:activityTimeout', {","\t\t\tbroadcast: 2","\t\t});","","\t\t/**","\t\tThis event is fired when the countdown on the warning panel reaches 0 and an automatic logout is triggered.","\t\tThis event is broadcasted to Y and Y.Global.","","\t\t@event ohp-activity-timeout:warningTimeout","\t\t**/","\t\tY.publish('ohp-activity-timeout:warningTimeout', {","\t\t\tbroadcast: 2","\t\t});","","\t\t// Use an instance of IO rather than Y.io for easier mocking in unit tests","\t\tthis._pingIo = new Y.IO();","","\t\tthis._cleanCurrentAction();","\t},","","\tdestructor: function() {","\t\tthis._disableActivityTimeout();","","\t\tif (this._activityTimeoutDetector) {","\t\t\tthis._activityTimeoutDetector.destroy();","\t\t}","\t\tif (this._activityTimeoutWarningPanel) {","\t\t\tthis._activityTimeoutWarningPanel.destroy();","\t\t}","","\t\tif (this._storageChangeEventListener) {","\t\t\tactivitySyncer.detachListener(this._storageChangeEventListener);","\t\t}","\t},","","\t/**","\tInitialises the ActivityTimeout instance with the given configuration and starts the timers. If this instance has already been started","\tor another instance exists on an ancestor frame then this method will do nothing.","","\t@method configureAndStart","\t@param {Object} config the configuration to apply before starting","\t\t@param {Function} config.logoutFn the function to execute when logging out due to timeout or user action","\t\t@param {Number} [config.timeout] the time in milliseconds to wait before logging out due to inactivity (defaults to 600000 (10mins))","\t\t@param {String} [config.pingUrl] the URL to ping (`GET`) to keep the session alive (if there is detected user activity)","\t\t@param {Number} [config.pingInterval] the time to wait between pings in milliseconds (defaults to 60000 i.e. 1 minute)","","\t@return `true` if the ActivityTimeout was successfully configured and started, `false` otherwise.","\t**/","\tconfigureAndStart: function(config) {","\t\tif (this._activityTimeoutEnabled || _ancestorFrameInstance) {","\t\t\treturn false;","\t\t}","","\t\tthis._activityTimeoutDetector = new Y.OHP.ActivityTimeout.Detector({","\t\t\ttimeout: config.timeout","\t\t});","\t\tthis._activityTimeoutWarningPanel = new Y.OHP.ActivityTimeout.WarningPanel();","","\t\tthis._set('logoutFn', config.logoutFn || function() {});","","\t\tif (config.pingUrl) {","\t\t\tthis._set('pingUrl', config.pingUrl);","\t\t}","\t\tif (config.pingInterval) {","\t\t\tthis._set('pingInterval', config.pingInterval);","\t\t}","","\t\tthis._enableActivityTimeout();","","\t\treturn true;","\t},","","\t/**","\tWhether the system is in the process of logging out due to inactivity.","","\t@method isAutomaticallyLoggingOut","\t@return `true` if the system is logging out due to user inactivity, `false` otherwise.","\t**/","\tisAutomaticallyLoggingOut: function() {","\t\tif (_ancestorFrameInstance) {","\t\t\treturn _ancestorFrameInstance.isAutomaticallyLoggingOut();","\t\t}","\t\treturn this.get('automaticallyLoggingOut');","\t},","","\t_enableActivityTimeout: function() {","\t\tthis._activityTimeoutDetector.start();","\t\tthis._activityTimeoutWarningPanel.render();","","\t\tif (this.get('pingUrl')) {","\t\t\tthis._keepAliveTimer = Y.later(this.get('pingInterval'), this, this._onPingIntervalDoPing, [], true);","\t\t}","","\t\tthis._eventSubscriptions.push(","\t\t\tY.Global.on('ohp-activity-timeout:activityTimeout', this._onActivityTimeoutShowWarningPanel, this),","\t\t\tY.Global.on('ohp-activity-timeout:warningTimeout', this._onWarningTimeoutInitiateLogout, this),","\t\t\tY.Global.on('ohp-activity-timeout:warningDismissed', this._onWarningDismissedCommunicateDismiss, this)","\t\t);","","\t\tthis._storageChangeEventListener = Y.bind(this._actionStorageChangeHandler, this);","\t\tactivitySyncer.attachListener(this._storageChangeEventListener);","","\t\tthis._activityTimeoutEnabled = true;","\t},","","\t_onPingIntervalDoPing: function() {","\t\tthis._pingIo.send(this.get('pingUrl'));","\t},","","\t_onActivityTimeoutShowWarningPanel: function() {","\t\tthis._initiateAction(ACTION_DISPLAY_WARNING);","\t\tthis._activityTimeoutWarningPanel.show();","\t},","","\t_onWarningTimeoutInitiateLogout: function() {","\t\tthis._initiateAction(ACTION_WARNING_TIMEOUT);","\t\tthis._performLogout();","\t},","","\t_onWarningDismissedCommunicateDismiss: function() {","\t\tthis._initiateAction(ACTION_WARNING_DISMISSED);","\t},","","\t_actionStorageChangeHandler: function(event) {","\t\tvar action = event.value;","","\t\tif (action === ACTION_DISPLAY_WARNING) {","\t\t\tY.fire('ohp-activity-timeout:activityTimeout');","\t\t} else if (action === ACTION_WARNING_DISMISSED) {","\t\t\tthis._activityTimeoutWarningPanel.dismiss();","","\t\t// Prevent triggering logout multiple times (specifically on IE 8 where the LocalStorage change event is vague)","\t\t} else if (action === ACTION_WARNING_TIMEOUT && !this.get('automaticallyLoggingOut')) {","\t\t\tY.fire('ohp-activity-timeout:warningTimeout');","\t\t}","\t},","","\t_initiateAction: function(action) {","\t\tvar currentAction = activitySyncer.get();","\t\tif (currentAction !== action) {","\t\t\tactivitySyncer.broadcast(action);","","\t\t\tY.later(1000, this, this._cleanCurrentAction);","\t\t}","\t},","","\t_cleanCurrentAction: function() {","\t\tactivitySyncer.clear();","\t},","","\t_performLogout: function() {","\t\tif (this.get('automaticallyLoggingOut')) {","\t\t\t// Prevent triggering logout multiple times (specifically on IE 8 where the LocalStorage change event is vague)","\t\t\treturn;","\t\t}","","\t\tthis._set('automaticallyLoggingOut', true);","\t\tthis._cancelKeepAliveTimer();","\t\tthis.get('logoutFn')();","\t},","","\t_cancelKeepAliveTimer: function() {","\t\tif (this._keepAliveTimer) {","\t\t\tthis._keepAliveTimer.cancel();","\t\t}","\t},","","\t_disableActivityTimeout: function() {","\t\tY.Array.invoke(this._eventSubscriptions, 'detach');","","\t\tthis._activityTimeoutDetector.stop();","\t\tthis._activityTimeoutWarningPanel.hide();","\t\tthis._cancelKeepAliveTimer();","\t\tthis._activityTimeoutEnabled = false;","\t}","}, {","\tATTRS: {","\t\t/**","\t\tThe URL to be used to ping server to keep session alive.","","\t\t@config pingUrl","\t\t@type String","\t\t@readOnly readOnly","\t\t**/","\t\tpingUrl: {","\t\t\treadOnly: true","\t\t},","","\t\t/**","\t\tThe interval of pinging server to keep session alive.","","\t\t@config pingInterval","\t\t@default 60000 milliseconds(1 mins)","\t\t@type Number","\t\t@readOnly readOnly","\t\t**/","\t\tpingInterval: {","\t\t\tvalue: DEFAULT_PING_INTERVAL,","\t\t\treadOnly: true","\t\t},","","\t\t/**","\t\tThe function to be called when warning panel times out to perform logout action.","","\t\t@config logoutFn","\t\t@type Function","\t\t@readOnly readOnly","\t\t**/","\t\tlogoutFn: {","\t\t\treadOnly: true","\t\t},","","\t\t/**","\t\tWhether the system is in the process of logging out due to inactivity.","","\t\t@config automaticallyLoggingOut","\t\t@type Boolean","\t\t@default false","\t\t@readOnly readOnly","\t\t**/","\t\tautomaticallyLoggingOut: {","\t\t\treadOnly: true,","\t\t\tvalue: false","\t\t}","\t}","});","","if (!GLOBAL_SINGLETON_NS._instance) {","\tGLOBAL_SINGLETON_NS._instance = new ActivityTimeout();","}","","Y.namespace('OHP').ActivityTimeout = Y.mix(GLOBAL_SINGLETON_NS._instance, Y.namespace('OHP.ActivityTimeout'));","","","}, '7.9.0', {","    \"requires\": [","        \"base\",","        \"node-base\",","        \"event-base\",","        \"event-custom\",","        \"yui-later\",","        \"array-invoke\",","        \"io-base\",","        \"ohp-activity-timeout-detector\",","        \"ohp-activity-timeout-warning-panel\",","        \"ohp-activity-tracker\",","        \"cow-activity-syncer\"","    ]","});","","}());"]};
}
__cov_ELdXZxPupLJwxf7gY0ONxQ = __cov_ELdXZxPupLJwxf7gY0ONxQ['/build/work/UIE-COW-JOB1/Common-Web/com.orchestral.commonweb/web/ohp-activity-timeout/ohp-activity-timeout.js'];
__cov_ELdXZxPupLJwxf7gY0ONxQ.s['1']++;YUI.add('ohp-activity-timeout',function(Y,NAME){'use strict';__cov_ELdXZxPupLJwxf7gY0ONxQ.f['1']++;__cov_ELdXZxPupLJwxf7gY0ONxQ.s['2']++;var Lang=Y.Lang,win=Y.config.win,doc=Y.config.doc,ACTIVITY_TIMEOUT_ACTION_STORAGE_KEY='ohp-activity-timeout-action',activitySyncer=new Y.COW.ActivitySyncer(ACTIVITY_TIMEOUT_ACTION_STORAGE_KEY),DEFAULT_PING_INTERVAL=60*1000,ACTION_DISPLAY_WARNING='displayWarning',ACTION_WARNING_DISMISSED='warningDismissed',ACTION_WARNING_TIMEOUT='warningTimeout',GLOBAL_SINGLETON_NS=YUI.namespace('OHP.ActivityTimeout'),ActivityTimeout,_ancestorFrameInstance;function getInstanceOnAncestorFrame(currentWindow){__cov_ELdXZxPupLJwxf7gY0ONxQ.f['2']++;__cov_ELdXZxPupLJwxf7gY0ONxQ.s['4']++;var curr=(__cov_ELdXZxPupLJwxf7gY0ONxQ.b['1'][0]++,currentWindow)||(__cov_ELdXZxPupLJwxf7gY0ONxQ.b['1'][1]++,win),parentWindow=curr.parent,parentWindowNS;__cov_ELdXZxPupLJwxf7gY0ONxQ.s['5']++;if(curr===curr.top){__cov_ELdXZxPupLJwxf7gY0ONxQ.b['2'][0]++;__cov_ELdXZxPupLJwxf7gY0ONxQ.s['6']++;return null;}else{__cov_ELdXZxPupLJwxf7gY0ONxQ.b['2'][1]++;}__cov_ELdXZxPupLJwxf7gY0ONxQ.s['7']++;if(!Lang.isUndefined(parentWindow.YUI)){__cov_ELdXZxPupLJwxf7gY0ONxQ.b['3'][0]++;__cov_ELdXZxPupLJwxf7gY0ONxQ.s['8']++;parentWindowNS=parentWindow.YUI.namespace('OHP.ActivityTimeout');__cov_ELdXZxPupLJwxf7gY0ONxQ.s['9']++;if(parentWindowNS._instance){__cov_ELdXZxPupLJwxf7gY0ONxQ.b['4'][0]++;__cov_ELdXZxPupLJwxf7gY0ONxQ.s['10']++;return parentWindowNS._instance;}else{__cov_ELdXZxPupLJwxf7gY0ONxQ.b['4'][1]++;}}else{__cov_ELdXZxPupLJwxf7gY0ONxQ.b['3'][1]++;}__cov_ELdXZxPupLJwxf7gY0ONxQ.s['11']++;return getInstanceOnAncestorFrame(parentWindow);}__cov_ELdXZxPupLJwxf7gY0ONxQ.s['12']++;_ancestorFrameInstance=getInstanceOnAncestorFrame();__cov_ELdXZxPupLJwxf7gY0ONxQ.s['13']++;ActivityTimeout=Y.Base.create('ohp-activity-timeout',Y.Base,[],{initializer:function(){__cov_ELdXZxPupLJwxf7gY0ONxQ.f['3']++;__cov_ELdXZxPupLJwxf7gY0ONxQ.s['14']++;this._eventSubscriptions=[];__cov_ELdXZxPupLJwxf7gY0ONxQ.s['15']++;Y.publish('ohp-activity-timeout:activityTimeout',{broadcast:2});__cov_ELdXZxPupLJwxf7gY0ONxQ.s['16']++;Y.publish('ohp-activity-timeout:warningTimeout',{broadcast:2});__cov_ELdXZxPupLJwxf7gY0ONxQ.s['17']++;this._pingIo=new Y.IO();__cov_ELdXZxPupLJwxf7gY0ONxQ.s['18']++;this._cleanCurrentAction();},destructor:function(){__cov_ELdXZxPupLJwxf7gY0ONxQ.f['4']++;__cov_ELdXZxPupLJwxf7gY0ONxQ.s['19']++;this._disableActivityTimeout();__cov_ELdXZxPupLJwxf7gY0ONxQ.s['20']++;if(this._activityTimeoutDetector){__cov_ELdXZxPupLJwxf7gY0ONxQ.b['5'][0]++;__cov_ELdXZxPupLJwxf7gY0ONxQ.s['21']++;this._activityTimeoutDetector.destroy();}else{__cov_ELdXZxPupLJwxf7gY0ONxQ.b['5'][1]++;}__cov_ELdXZxPupLJwxf7gY0ONxQ.s['22']++;if(this._activityTimeoutWarningPanel){__cov_ELdXZxPupLJwxf7gY0ONxQ.b['6'][0]++;__cov_ELdXZxPupLJwxf7gY0ONxQ.s['23']++;this._activityTimeoutWarningPanel.destroy();}else{__cov_ELdXZxPupLJwxf7gY0ONxQ.b['6'][1]++;}__cov_ELdXZxPupLJwxf7gY0ONxQ.s['24']++;if(this._storageChangeEventListener){__cov_ELdXZxPupLJwxf7gY0ONxQ.b['7'][0]++;__cov_ELdXZxPupLJwxf7gY0ONxQ.s['25']++;activitySyncer.detachListener(this._storageChangeEventListener);}else{__cov_ELdXZxPupLJwxf7gY0ONxQ.b['7'][1]++;}},configureAndStart:function(config){__cov_ELdXZxPupLJwxf7gY0ONxQ.f['5']++;__cov_ELdXZxPupLJwxf7gY0ONxQ.s['26']++;if((__cov_ELdXZxPupLJwxf7gY0ONxQ.b['9'][0]++,this._activityTimeoutEnabled)||(__cov_ELdXZxPupLJwxf7gY0ONxQ.b['9'][1]++,_ancestorFrameInstance)){__cov_ELdXZxPupLJwxf7gY0ONxQ.b['8'][0]++;__cov_ELdXZxPupLJwxf7gY0ONxQ.s['27']++;return false;}else{__cov_ELdXZxPupLJwxf7gY0ONxQ.b['8'][1]++;}__cov_ELdXZxPupLJwxf7gY0ONxQ.s['28']++;this._activityTimeoutDetector=new Y.OHP.ActivityTimeout.Detector({timeout:config.timeout});__cov_ELdXZxPupLJwxf7gY0ONxQ.s['29']++;this._activityTimeoutWarningPanel=new Y.OHP.ActivityTimeout.WarningPanel();__cov_ELdXZxPupLJwxf7gY0ONxQ.s['30']++;this._set('logoutFn',(__cov_ELdXZxPupLJwxf7gY0ONxQ.b['10'][0]++,config.logoutFn)||(__cov_ELdXZxPupLJwxf7gY0ONxQ.b['10'][1]++,function(){__cov_ELdXZxPupLJwxf7gY0ONxQ.f['6']++;}));__cov_ELdXZxPupLJwxf7gY0ONxQ.s['31']++;if(config.pingUrl){__cov_ELdXZxPupLJwxf7gY0ONxQ.b['11'][0]++;__cov_ELdXZxPupLJwxf7gY0ONxQ.s['32']++;this._set('pingUrl',config.pingUrl);}else{__cov_ELdXZxPupLJwxf7gY0ONxQ.b['11'][1]++;}__cov_ELdXZxPupLJwxf7gY0ONxQ.s['33']++;if(config.pingInterval){__cov_ELdXZxPupLJwxf7gY0ONxQ.b['12'][0]++;__cov_ELdXZxPupLJwxf7gY0ONxQ.s['34']++;this._set('pingInterval',config.pingInterval);}else{__cov_ELdXZxPupLJwxf7gY0ONxQ.b['12'][1]++;}__cov_ELdXZxPupLJwxf7gY0ONxQ.s['35']++;this._enableActivityTimeout();__cov_ELdXZxPupLJwxf7gY0ONxQ.s['36']++;return true;},isAutomaticallyLoggingOut:function(){__cov_ELdXZxPupLJwxf7gY0ONxQ.f['7']++;__cov_ELdXZxPupLJwxf7gY0ONxQ.s['37']++;if(_ancestorFrameInstance){__cov_ELdXZxPupLJwxf7gY0ONxQ.b['13'][0]++;__cov_ELdXZxPupLJwxf7gY0ONxQ.s['38']++;return _ancestorFrameInstance.isAutomaticallyLoggingOut();}else{__cov_ELdXZxPupLJwxf7gY0ONxQ.b['13'][1]++;}__cov_ELdXZxPupLJwxf7gY0ONxQ.s['39']++;return this.get('automaticallyLoggingOut');},_enableActivityTimeout:function(){__cov_ELdXZxPupLJwxf7gY0ONxQ.f['8']++;__cov_ELdXZxPupLJwxf7gY0ONxQ.s['40']++;this._activityTimeoutDetector.start();__cov_ELdXZxPupLJwxf7gY0ONxQ.s['41']++;this._activityTimeoutWarningPanel.render();__cov_ELdXZxPupLJwxf7gY0ONxQ.s['42']++;if(this.get('pingUrl')){__cov_ELdXZxPupLJwxf7gY0ONxQ.b['14'][0]++;__cov_ELdXZxPupLJwxf7gY0ONxQ.s['43']++;this._keepAliveTimer=Y.later(this.get('pingInterval'),this,this._onPingIntervalDoPing,[],true);}else{__cov_ELdXZxPupLJwxf7gY0ONxQ.b['14'][1]++;}__cov_ELdXZxPupLJwxf7gY0ONxQ.s['44']++;this._eventSubscriptions.push(Y.Global.on('ohp-activity-timeout:activityTimeout',this._onActivityTimeoutShowWarningPanel,this),Y.Global.on('ohp-activity-timeout:warningTimeout',this._onWarningTimeoutInitiateLogout,this),Y.Global.on('ohp-activity-timeout:warningDismissed',this._onWarningDismissedCommunicateDismiss,this));__cov_ELdXZxPupLJwxf7gY0ONxQ.s['45']++;this._storageChangeEventListener=Y.bind(this._actionStorageChangeHandler,this);__cov_ELdXZxPupLJwxf7gY0ONxQ.s['46']++;activitySyncer.attachListener(this._storageChangeEventListener);__cov_ELdXZxPupLJwxf7gY0ONxQ.s['47']++;this._activityTimeoutEnabled=true;},_onPingIntervalDoPing:function(){__cov_ELdXZxPupLJwxf7gY0ONxQ.f['9']++;__cov_ELdXZxPupLJwxf7gY0ONxQ.s['48']++;this._pingIo.send(this.get('pingUrl'));},_onActivityTimeoutShowWarningPanel:function(){__cov_ELdXZxPupLJwxf7gY0ONxQ.f['10']++;__cov_ELdXZxPupLJwxf7gY0ONxQ.s['49']++;this._initiateAction(ACTION_DISPLAY_WARNING);__cov_ELdXZxPupLJwxf7gY0ONxQ.s['50']++;this._activityTimeoutWarningPanel.show();},_onWarningTimeoutInitiateLogout:function(){__cov_ELdXZxPupLJwxf7gY0ONxQ.f['11']++;__cov_ELdXZxPupLJwxf7gY0ONxQ.s['51']++;this._initiateAction(ACTION_WARNING_TIMEOUT);__cov_ELdXZxPupLJwxf7gY0ONxQ.s['52']++;this._performLogout();},_onWarningDismissedCommunicateDismiss:function(){__cov_ELdXZxPupLJwxf7gY0ONxQ.f['12']++;__cov_ELdXZxPupLJwxf7gY0ONxQ.s['53']++;this._initiateAction(ACTION_WARNING_DISMISSED);},_actionStorageChangeHandler:function(event){__cov_ELdXZxPupLJwxf7gY0ONxQ.f['13']++;__cov_ELdXZxPupLJwxf7gY0ONxQ.s['54']++;var action=event.value;__cov_ELdXZxPupLJwxf7gY0ONxQ.s['55']++;if(action===ACTION_DISPLAY_WARNING){__cov_ELdXZxPupLJwxf7gY0ONxQ.b['15'][0]++;__cov_ELdXZxPupLJwxf7gY0ONxQ.s['56']++;Y.fire('ohp-activity-timeout:activityTimeout');}else{__cov_ELdXZxPupLJwxf7gY0ONxQ.b['15'][1]++;__cov_ELdXZxPupLJwxf7gY0ONxQ.s['57']++;if(action===ACTION_WARNING_DISMISSED){__cov_ELdXZxPupLJwxf7gY0ONxQ.b['16'][0]++;__cov_ELdXZxPupLJwxf7gY0ONxQ.s['58']++;this._activityTimeoutWarningPanel.dismiss();}else{__cov_ELdXZxPupLJwxf7gY0ONxQ.b['16'][1]++;__cov_ELdXZxPupLJwxf7gY0ONxQ.s['59']++;if((__cov_ELdXZxPupLJwxf7gY0ONxQ.b['18'][0]++,action===ACTION_WARNING_TIMEOUT)&&(__cov_ELdXZxPupLJwxf7gY0ONxQ.b['18'][1]++,!this.get('automaticallyLoggingOut'))){__cov_ELdXZxPupLJwxf7gY0ONxQ.b['17'][0]++;__cov_ELdXZxPupLJwxf7gY0ONxQ.s['60']++;Y.fire('ohp-activity-timeout:warningTimeout');}else{__cov_ELdXZxPupLJwxf7gY0ONxQ.b['17'][1]++;}}}},_initiateAction:function(action){__cov_ELdXZxPupLJwxf7gY0ONxQ.f['14']++;__cov_ELdXZxPupLJwxf7gY0ONxQ.s['61']++;var currentAction=activitySyncer.get();__cov_ELdXZxPupLJwxf7gY0ONxQ.s['62']++;if(currentAction!==action){__cov_ELdXZxPupLJwxf7gY0ONxQ.b['19'][0]++;__cov_ELdXZxPupLJwxf7gY0ONxQ.s['63']++;activitySyncer.broadcast(action);__cov_ELdXZxPupLJwxf7gY0ONxQ.s['64']++;Y.later(1000,this,this._cleanCurrentAction);}else{__cov_ELdXZxPupLJwxf7gY0ONxQ.b['19'][1]++;}},_cleanCurrentAction:function(){__cov_ELdXZxPupLJwxf7gY0ONxQ.f['15']++;__cov_ELdXZxPupLJwxf7gY0ONxQ.s['65']++;activitySyncer.clear();},_performLogout:function(){__cov_ELdXZxPupLJwxf7gY0ONxQ.f['16']++;__cov_ELdXZxPupLJwxf7gY0ONxQ.s['66']++;if(this.get('automaticallyLoggingOut')){__cov_ELdXZxPupLJwxf7gY0ONxQ.b['20'][0]++;__cov_ELdXZxPupLJwxf7gY0ONxQ.s['67']++;return;}else{__cov_ELdXZxPupLJwxf7gY0ONxQ.b['20'][1]++;}__cov_ELdXZxPupLJwxf7gY0ONxQ.s['68']++;this._set('automaticallyLoggingOut',true);__cov_ELdXZxPupLJwxf7gY0ONxQ.s['69']++;this._cancelKeepAliveTimer();__cov_ELdXZxPupLJwxf7gY0ONxQ.s['70']++;this.get('logoutFn')();},_cancelKeepAliveTimer:function(){__cov_ELdXZxPupLJwxf7gY0ONxQ.f['17']++;__cov_ELdXZxPupLJwxf7gY0ONxQ.s['71']++;if(this._keepAliveTimer){__cov_ELdXZxPupLJwxf7gY0ONxQ.b['21'][0]++;__cov_ELdXZxPupLJwxf7gY0ONxQ.s['72']++;this._keepAliveTimer.cancel();}else{__cov_ELdXZxPupLJwxf7gY0ONxQ.b['21'][1]++;}},_disableActivityTimeout:function(){__cov_ELdXZxPupLJwxf7gY0ONxQ.f['18']++;__cov_ELdXZxPupLJwxf7gY0ONxQ.s['73']++;Y.Array.invoke(this._eventSubscriptions,'detach');__cov_ELdXZxPupLJwxf7gY0ONxQ.s['74']++;this._activityTimeoutDetector.stop();__cov_ELdXZxPupLJwxf7gY0ONxQ.s['75']++;this._activityTimeoutWarningPanel.hide();__cov_ELdXZxPupLJwxf7gY0ONxQ.s['76']++;this._cancelKeepAliveTimer();__cov_ELdXZxPupLJwxf7gY0ONxQ.s['77']++;this._activityTimeoutEnabled=false;}},{ATTRS:{pingUrl:{readOnly:true},pingInterval:{value:DEFAULT_PING_INTERVAL,readOnly:true},logoutFn:{readOnly:true},automaticallyLoggingOut:{readOnly:true,value:false}}});__cov_ELdXZxPupLJwxf7gY0ONxQ.s['78']++;if(!GLOBAL_SINGLETON_NS._instance){__cov_ELdXZxPupLJwxf7gY0ONxQ.b['22'][0]++;__cov_ELdXZxPupLJwxf7gY0ONxQ.s['79']++;GLOBAL_SINGLETON_NS._instance=new ActivityTimeout();}else{__cov_ELdXZxPupLJwxf7gY0ONxQ.b['22'][1]++;}__cov_ELdXZxPupLJwxf7gY0ONxQ.s['80']++;Y.namespace('OHP').ActivityTimeout=Y.mix(GLOBAL_SINGLETON_NS._instance,Y.namespace('OHP.ActivityTimeout'));},'7.9.0',{'requires':['base','node-base','event-base','event-custom','yui-later','array-invoke','io-base','ohp-activity-timeout-detector','ohp-activity-timeout-warning-panel','ohp-activity-tracker','cow-activity-syncer']});
