/*
 * Copyright (c) Orchestral Developments Ltd (2001 - 2014).
 *
 * This document is copyright. Except for the purpose of fair reviewing, no part
 * of this publication may be reproduced or transmitted in any form or by any
 * means, electronic or mechanical, including photocopying, recording, or any
 * information storage and retrieval system, without permission in writing from
 * the publisher. Infringers of copyright render themselves liable for
 * prosecution.
 */
YUI.add("ohp-expand-collapse-plugin",function(e,t){"use strict";function n(){n.superclass.constructor.apply(this,arguments)}n.NAME="expandCollapse",n.NS="details",n.ATTRS={summary:{valueFn:function(){return this._getDefaultSummary()},validator:function(t){return e.Lang.isString(t)||e.instanceOf(t,e.Node)},setter:function(t){return e.Lang.isString(t)?e.Node.one(t):t}},trigger:{valueFn:function(){return this._getDefaultTrigger()},validator:function(t){return e.Lang.isString(t)||e.instanceOf(t,e.Node)},setter:function(t){return e.Lang.isString(t)?e.Node.one(t):t}},open:{value:!1}},n.CONTAINER_CLASS="ohp-expand-collapse",n.OPEN_CLASS="ohp-expand-collapse-open",n.CLOSED_CLASS="ohp-expand-collapse-closed",n.SUMMARY_CLASS="ohp-expand-collapse-summary",n.DETAILS_CLASS="ohp-expand-collapse-details",n.TRIGGER_CLASS="ohp-expand-collapse-trigger",e.extend(n,e.Plugin.Base,{initializer:function(){var e=this.get("host"),t=this.get("trigger");e.addClass(n.CONTAINER_CLASS),this._updateDetails(),this.publish("expand",{defaultFn:this._defExpandFn,broadcast:2,emitFacade:!0}),this.publish("collapse",{defaultFn:this._defCollapseFn,broadcast:2,emitFacade:!0}),t.on("click",function(e){this.toggle(),e.preventDefault()},this),this.get("open")?this.expand():this.collapse(),this.afterHostMethod("append",this._updateDetails),this.afterHostMethod("appendChild",this._updateDetails),this.afterHostMethod("insert",this._updateDetails),this.afterHostMethod("replaceChild",this._updateDetails),this.afterHostMethod("setContent",this._updateDetails)},_getDefaultSummary:function(){var e=this.get("host"),t=e.one("."+n.SUMMARY_CLASS);if(!t){t=e.one("*");if(!t)return}return t.addClass(n.SUMMARY_CLASS),t},_getDefaultTrigger:function(){var e=this.get("summary");return e.addClass(n.TRIGGER_CLASS),e},_updateDetails:function(){var e=this.get("summary"),t=this.get("trigger"),r;e||(e=this._getDefaultSummary(),this.set("summary",e)),t||(t=this._getDefaultTrigger(),this.set("trigger",t)),r=e.siblings(function(e){e.hasClass(n.DETAILS_CLASS)||e.addClass(n.DETAILS_CLASS)})},_defExpandFn:function(){var e=this.get("host"),t=this.get("trigger");this.set("open",!0),e.replaceClass(n.CLOSED_CLASS,n.OPEN_CLASS),t.replaceClass(n.CLOSED_CLASS,n.OPEN_CLASS)},_defCollapseFn:function(){var e=this.get("host"),t=this.get("trigger");this.set("open",!1),e.replaceClass(n.OPEN_CLASS,n.CLOSED_CLASS),t.replaceClass(n.OPEN_CLASS,n.CLOSED_CLASS)},expand:function(){this.fire("expand",{node:this.get("host")})},collapse:function(){this.fire("collapse",{node:this.get("host")})},toggle:function(){this.get("open")?this.fire("collapse",{node:this.get("host")}):this.fire("expand",{node:this.get("host")})}}),e.namespace("OHP").ExpandCollapsePlugin=n},"7.9.0",{requires:["node-core","base-build","event-custom","node-pluginhost","event-base","plugin","node-base"],skinnable:!0});
