/*
 * Copyright (c) Orchestral Developments Ltd (2001 - 2014).
 *
 * This document is copyright. Except for the purpose of fair reviewing, no part
 * of this publication may be reproduced or transmitted in any form or by any
 * means, electronic or mechanical, including photocopying, recording, or any
 * information storage and retrieval system, without permission in writing from
 * the publisher. Infringers of copyright render themselves liable for
 * prosecution.
 */

var __cov_qRk17qMaNpKVEzeLYLR6dw = (Function('return this'))();
if (!__cov_qRk17qMaNpKVEzeLYLR6dw.__coverage__) { __cov_qRk17qMaNpKVEzeLYLR6dw.__coverage__ = {}; }
__cov_qRk17qMaNpKVEzeLYLR6dw = __cov_qRk17qMaNpKVEzeLYLR6dw.__coverage__;
if (!(__cov_qRk17qMaNpKVEzeLYLR6dw['/build/work/UIE-COW-JOB1/Common-Web/com.orchestral.commonweb/web/cow-activity-syncer/cow-activity-syncer.js'])) {
   __cov_qRk17qMaNpKVEzeLYLR6dw['/build/work/UIE-COW-JOB1/Common-Web/com.orchestral.commonweb/web/cow-activity-syncer/cow-activity-syncer.js'] = {"path":"/build/work/UIE-COW-JOB1/Common-Web/com.orchestral.commonweb/web/cow-activity-syncer/cow-activity-syncer.js","s":{"1":0,"2":0,"3":0,"4":1,"5":0,"6":0,"7":0,"8":0,"9":1,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0},"fnMap":{"1":{"name":"(anonymous_1)","line":2,"loc":{"start":{"line":2,"column":31},"end":{"line":2,"column":50}}},"2":{"name":"(anonymous_2)","line":9,"loc":{"start":{"line":9,"column":11},"end":{"line":9,"column":40}}},"3":{"name":"(anonymous_3)","line":10,"loc":{"start":{"line":10,"column":14},"end":{"line":10,"column":36}}},"4":{"name":"(anonymous_4)","line":11,"loc":{"start":{"line":11,"column":11},"end":{"line":11,"column":33}}},"5":{"name":"_addStorageChangeEventListener","line":19,"loc":{"start":{"line":19,"column":0},"end":{"line":19,"column":55}}},"6":{"name":"_removeStorageChangeEventListener","line":29,"loc":{"start":{"line":29,"column":0},"end":{"line":29,"column":58}}},"7":{"name":"(anonymous_7)","line":45,"loc":{"start":{"line":45,"column":17},"end":{"line":45,"column":38}}},"8":{"name":"(anonymous_8)","line":57,"loc":{"start":{"line":57,"column":37},"end":{"line":57,"column":55}}},"9":{"name":"(anonymous_9)","line":71,"loc":{"start":{"line":71,"column":31},"end":{"line":71,"column":42}}},"10":{"name":"(anonymous_10)","line":76,"loc":{"start":{"line":76,"column":44},"end":{"line":76,"column":55}}},"11":{"name":"(anonymous_11)","line":85,"loc":{"start":{"line":85,"column":33},"end":{"line":85,"column":44}}},"12":{"name":"(anonymous_12)","line":100,"loc":{"start":{"line":100,"column":42},"end":{"line":100,"column":75}}},"13":{"name":"(anonymous_13)","line":101,"loc":{"start":{"line":101,"column":30},"end":{"line":101,"column":44}}},"14":{"name":"(anonymous_14)","line":127,"loc":{"start":{"line":127,"column":42},"end":{"line":127,"column":66}}},"15":{"name":"(anonymous_15)","line":136,"loc":{"start":{"line":136,"column":46},"end":{"line":136,"column":57}}}},"statementMap":{"1":{"start":{"line":2,"column":0},"end":{"line":147,"column":60}},"2":{"start":{"line":5,"column":0},"end":{"line":17,"column":16}},"3":{"start":{"line":12,"column":3},"end":{"line":12,"column":15}},"4":{"start":{"line":19,"column":0},"end":{"line":27,"column":1}},"5":{"start":{"line":20,"column":1},"end":{"line":26,"column":2}},"6":{"start":{"line":22,"column":2},"end":{"line":22,"column":56}},"7":{"start":{"line":23,"column":8},"end":{"line":26,"column":2}},"8":{"start":{"line":25,"column":2},"end":{"line":25,"column":46}},"9":{"start":{"line":29,"column":0},"end":{"line":37,"column":1}},"10":{"start":{"line":30,"column":1},"end":{"line":36,"column":2}},"11":{"start":{"line":32,"column":2},"end":{"line":32,"column":59}},"12":{"start":{"line":33,"column":8},"end":{"line":36,"column":2}},"13":{"start":{"line":35,"column":2},"end":{"line":35,"column":46}},"14":{"start":{"line":45,"column":0},"end":{"line":49,"column":2}},"15":{"start":{"line":46,"column":1},"end":{"line":46,"column":31}},"16":{"start":{"line":47,"column":1},"end":{"line":47,"column":22}},"17":{"start":{"line":48,"column":1},"end":{"line":48,"column":31}},"18":{"start":{"line":57,"column":0},"end":{"line":63,"column":2}},"19":{"start":{"line":58,"column":1},"end":{"line":61,"column":3}},"20":{"start":{"line":62,"column":1},"end":{"line":62,"column":70}},"21":{"start":{"line":71,"column":0},"end":{"line":74,"column":2}},"22":{"start":{"line":72,"column":1},"end":{"line":72,"column":44}},"23":{"start":{"line":73,"column":1},"end":{"line":73,"column":45}},"24":{"start":{"line":76,"column":0},"end":{"line":78,"column":2}},"25":{"start":{"line":77,"column":1},"end":{"line":77,"column":59}},"26":{"start":{"line":85,"column":0},"end":{"line":87,"column":2}},"27":{"start":{"line":86,"column":1},"end":{"line":86,"column":41}},"28":{"start":{"line":100,"column":0},"end":{"line":118,"column":2}},"29":{"start":{"line":101,"column":1},"end":{"line":114,"column":10}},"30":{"start":{"line":102,"column":2},"end":{"line":103,"column":41}},"31":{"start":{"line":105,"column":2},"end":{"line":113,"column":3}},"32":{"start":{"line":106,"column":3},"end":{"line":110,"column":6}},"33":{"start":{"line":112,"column":3},"end":{"line":112,"column":41}},"34":{"start":{"line":116,"column":1},"end":{"line":116,"column":50}},"35":{"start":{"line":117,"column":1},"end":{"line":117,"column":49}},"36":{"start":{"line":127,"column":0},"end":{"line":129,"column":2}},"37":{"start":{"line":128,"column":1},"end":{"line":128,"column":67}},"38":{"start":{"line":136,"column":0},"end":{"line":142,"column":2}},"39":{"start":{"line":137,"column":1},"end":{"line":141,"column":2}},"40":{"start":{"line":138,"column":2},"end":{"line":140,"column":3}},"41":{"start":{"line":139,"column":3},"end":{"line":139,"column":38}},"42":{"start":{"line":144,"column":0},"end":{"line":144,"column":51}}},"branchMap":{"1":{"line":15,"type":"cond-expr","locations":[{"start":{"line":15,"column":52},"end":{"line":15,"column":77}},{"start":{"line":15,"column":80},"end":{"line":15,"column":96}}]},"2":{"line":20,"type":"if","locations":[{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},{"start":{"line":20,"column":1},"end":{"line":20,"column":1}}]},"3":{"line":23,"type":"if","locations":[{"start":{"line":23,"column":8},"end":{"line":23,"column":8}},{"start":{"line":23,"column":8},"end":{"line":23,"column":8}}]},"4":{"line":30,"type":"if","locations":[{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},{"start":{"line":30,"column":1},"end":{"line":30,"column":1}}]},"5":{"line":33,"type":"if","locations":[{"start":{"line":33,"column":8},"end":{"line":33,"column":8}},{"start":{"line":33,"column":8},"end":{"line":33,"column":8}}]},"6":{"line":59,"type":"binary-expr","locations":[{"start":{"line":59,"column":11},"end":{"line":59,"column":18}},{"start":{"line":59,"column":22},"end":{"line":59,"column":24}}]},"7":{"line":73,"type":"binary-expr","locations":[{"start":{"line":73,"column":8},"end":{"line":73,"column":20}},{"start":{"line":73,"column":24},"end":{"line":73,"column":44}}]},"8":{"line":102,"type":"binary-expr","locations":[{"start":{"line":102,"column":21},"end":{"line":102,"column":44}},{"start":{"line":102,"column":48},"end":{"line":102,"column":50}}]},"9":{"line":105,"type":"if","locations":[{"start":{"line":105,"column":2},"end":{"line":105,"column":2}},{"start":{"line":105,"column":2},"end":{"line":105,"column":2}}]},"10":{"line":105,"type":"binary-expr","locations":[{"start":{"line":105,"column":6},"end":{"line":105,"column":18}},{"start":{"line":105,"column":22},"end":{"line":105,"column":61}}]},"11":{"line":138,"type":"if","locations":[{"start":{"line":138,"column":2},"end":{"line":138,"column":2}},{"start":{"line":138,"column":2},"end":{"line":138,"column":2}}]}},"code":["(function () { /*!(C) ORCHESTRAL*/","YUI.add('cow-activity-syncer', function (Y, NAME) {","","\"use strict\";","var win = Y.config.win,","\tdoc = Y.config.doc,","","\tLocalStorageNoOp = {","\t\tsetItem: function( /* key, value */ ) {},","\t\tremoveItem: function( /* key */ ) {},","\t\tgetItem: function( /* key */ ) {","\t\t\treturn null;","\t\t}","\t},","\tLocStorage = Y.config.win.Modernizr.localstorage ? Y.config.win.localStorage : LocalStorageNoOp,","","\tActivitySyncer;","","function _addStorageChangeEventListener(eventListener) {","\tif (win.addEventListener) {","\t\t// addEventListener is only available in IE9+ and other modern browsers.","\t\twin.addEventListener('storage', eventListener, false);","\t} else if (doc.attachEvent) {","\t\t// IE8 uses attachEvent, and the onstorage event is on document instead of window.","\t\tdoc.attachEvent('onstorage', eventListener);","\t}","}","","function _removeStorageChangeEventListener(eventListener) {","\tif (win.removeEventListener) {","\t\t// removeEventListener is only available in IE9+ and other modern browsers.","\t\twin.removeEventListener('storage', eventListener, false);","\t} else if (doc.detachEvent) {","\t\t// IE8 uses detachEvent, and the onstorage event is on document instead of window.","\t\tdoc.detachEvent('onstorage', eventListener);","\t}","}","","/**","@class ActivitySyncer","@constructor","@namespace COW","@param storageKey The key used to store value in the LocalStorage","**/","ActivitySyncer = function(storageKey) {","\tthis._storageKey = storageKey;","\tthis._listeners = {};","\tthis._lastModifiedTime = null;","};","","/*","Broadcast an activity to all other windows from the same domain.","","@method broadcast","@param {String} [payload] The payload object is accessible for all windows via the attached listeners.","*/","ActivitySyncer.prototype.broadcast = function(payload) {","\tvar wrappedValue = {","\t\tpayload: payload || {},","\t\ttimestamp: Y.Lang.now()","\t};","\tLocStorage.setItem(this._storageKey, Y.JSON.stringify(wrappedValue));","};","","/*","Get the current activity payload data.","","@method get","@return {Object} The current activity payload data.","*/","ActivitySyncer.prototype.get = function() {","\tvar wrappedValue = this._getWrappedValue();","\treturn wrappedValue && wrappedValue.payload;","};","","ActivitySyncer.prototype._getWrappedValue = function() {","\treturn Y.JSON.parse(LocStorage.getItem(this._storageKey));","};","","/*","Clear the activity data from LocalStorage","","@method clear","*/","ActivitySyncer.prototype.clear = function() {","\tLocStorage.removeItem(this._storageKey);","};","","/*","Attach an event listener that gets called when an activity is broadcast.","","@method attachListener","@param {Function} [eventListener] The event listener of broadcast activity","\t@param {Object} [event] A custom event facade","\t\t@param {StorageEvent} [originalEvent] The original StorageEvent","\t\t@param {String} [key] The key of the changed item in LocalStorage","\t\t@param {Object} [value] The latest value of the changed item in LocalStorage","@param {Object} [context] the execution context of the event listener","*/","ActivitySyncer.prototype.attachListener = function(eventListener, context) {","\tvar wrappedListener = Y.bind(function(evt) {","\t\tvar wrappedValue = this._getWrappedValue() || {},","\t\t\tmodifiedTime = wrappedValue.timestamp;","","\t\tif (modifiedTime && modifiedTime !== this._lastModifiedTime) {","\t\t\teventListener.call(context, {","\t\t\t\toriginalEvent: evt,","\t\t\t\tkey: this._storageKey,","\t\t\t\tvalue: this.get()","\t\t\t});","","\t\t\tthis._lastModifiedTime = modifiedTime;","\t\t}","\t}, this);","","\tthis._listeners[eventListener] = wrappedListener;","\t_addStorageChangeEventListener(wrappedListener);","};","","/*","Detach an event listener. The listener function must be the same with the one that is attached,","otherwise nothing will be detached.","","@method","@param {Function} [eventListener] The event listener of broadcast activity","*/","ActivitySyncer.prototype.detachListener = function(eventListener) {","\t_removeStorageChangeEventListener(this._listeners[eventListener]);","};","","/*","Detach all event listeners.","","@method","*/","ActivitySyncer.prototype.detachAllListeners = function() {","\tfor (var eventListener in this._listeners) {","\t\tif (this._listeners.hasOwnProperty(eventListener)) {","\t\t\tthis.detachListener(eventListener);","\t\t}","\t}","};","","Y.namespace('COW').ActivitySyncer = ActivitySyncer;","","","}, '7.9.0', {\"requires\": [\"json-stringify\", \"json-parse\"]});","","}());"]};
}
__cov_qRk17qMaNpKVEzeLYLR6dw = __cov_qRk17qMaNpKVEzeLYLR6dw['/build/work/UIE-COW-JOB1/Common-Web/com.orchestral.commonweb/web/cow-activity-syncer/cow-activity-syncer.js'];
__cov_qRk17qMaNpKVEzeLYLR6dw.s['1']++;YUI.add('cow-activity-syncer',function(Y,NAME){'use strict';__cov_qRk17qMaNpKVEzeLYLR6dw.f['1']++;__cov_qRk17qMaNpKVEzeLYLR6dw.s['2']++;var win=Y.config.win,doc=Y.config.doc,LocalStorageNoOp={setItem:function(){__cov_qRk17qMaNpKVEzeLYLR6dw.f['2']++;},removeItem:function(){__cov_qRk17qMaNpKVEzeLYLR6dw.f['3']++;},getItem:function(){__cov_qRk17qMaNpKVEzeLYLR6dw.f['4']++;__cov_qRk17qMaNpKVEzeLYLR6dw.s['3']++;return null;}},LocStorage=Y.config.win.Modernizr.localstorage?(__cov_qRk17qMaNpKVEzeLYLR6dw.b['1'][0]++,Y.config.win.localStorage):(__cov_qRk17qMaNpKVEzeLYLR6dw.b['1'][1]++,LocalStorageNoOp),ActivitySyncer;function _addStorageChangeEventListener(eventListener){__cov_qRk17qMaNpKVEzeLYLR6dw.f['5']++;__cov_qRk17qMaNpKVEzeLYLR6dw.s['5']++;if(win.addEventListener){__cov_qRk17qMaNpKVEzeLYLR6dw.b['2'][0]++;__cov_qRk17qMaNpKVEzeLYLR6dw.s['6']++;win.addEventListener('storage',eventListener,false);}else{__cov_qRk17qMaNpKVEzeLYLR6dw.b['2'][1]++;__cov_qRk17qMaNpKVEzeLYLR6dw.s['7']++;if(doc.attachEvent){__cov_qRk17qMaNpKVEzeLYLR6dw.b['3'][0]++;__cov_qRk17qMaNpKVEzeLYLR6dw.s['8']++;doc.attachEvent('onstorage',eventListener);}else{__cov_qRk17qMaNpKVEzeLYLR6dw.b['3'][1]++;}}}function _removeStorageChangeEventListener(eventListener){__cov_qRk17qMaNpKVEzeLYLR6dw.f['6']++;__cov_qRk17qMaNpKVEzeLYLR6dw.s['10']++;if(win.removeEventListener){__cov_qRk17qMaNpKVEzeLYLR6dw.b['4'][0]++;__cov_qRk17qMaNpKVEzeLYLR6dw.s['11']++;win.removeEventListener('storage',eventListener,false);}else{__cov_qRk17qMaNpKVEzeLYLR6dw.b['4'][1]++;__cov_qRk17qMaNpKVEzeLYLR6dw.s['12']++;if(doc.detachEvent){__cov_qRk17qMaNpKVEzeLYLR6dw.b['5'][0]++;__cov_qRk17qMaNpKVEzeLYLR6dw.s['13']++;doc.detachEvent('onstorage',eventListener);}else{__cov_qRk17qMaNpKVEzeLYLR6dw.b['5'][1]++;}}}__cov_qRk17qMaNpKVEzeLYLR6dw.s['14']++;ActivitySyncer=function(storageKey){__cov_qRk17qMaNpKVEzeLYLR6dw.f['7']++;__cov_qRk17qMaNpKVEzeLYLR6dw.s['15']++;this._storageKey=storageKey;__cov_qRk17qMaNpKVEzeLYLR6dw.s['16']++;this._listeners={};__cov_qRk17qMaNpKVEzeLYLR6dw.s['17']++;this._lastModifiedTime=null;};__cov_qRk17qMaNpKVEzeLYLR6dw.s['18']++;ActivitySyncer.prototype.broadcast=function(payload){__cov_qRk17qMaNpKVEzeLYLR6dw.f['8']++;__cov_qRk17qMaNpKVEzeLYLR6dw.s['19']++;var wrappedValue={payload:(__cov_qRk17qMaNpKVEzeLYLR6dw.b['6'][0]++,payload)||(__cov_qRk17qMaNpKVEzeLYLR6dw.b['6'][1]++,{}),timestamp:Y.Lang.now()};__cov_qRk17qMaNpKVEzeLYLR6dw.s['20']++;LocStorage.setItem(this._storageKey,Y.JSON.stringify(wrappedValue));};__cov_qRk17qMaNpKVEzeLYLR6dw.s['21']++;ActivitySyncer.prototype.get=function(){__cov_qRk17qMaNpKVEzeLYLR6dw.f['9']++;__cov_qRk17qMaNpKVEzeLYLR6dw.s['22']++;var wrappedValue=this._getWrappedValue();__cov_qRk17qMaNpKVEzeLYLR6dw.s['23']++;return(__cov_qRk17qMaNpKVEzeLYLR6dw.b['7'][0]++,wrappedValue)&&(__cov_qRk17qMaNpKVEzeLYLR6dw.b['7'][1]++,wrappedValue.payload);};__cov_qRk17qMaNpKVEzeLYLR6dw.s['24']++;ActivitySyncer.prototype._getWrappedValue=function(){__cov_qRk17qMaNpKVEzeLYLR6dw.f['10']++;__cov_qRk17qMaNpKVEzeLYLR6dw.s['25']++;return Y.JSON.parse(LocStorage.getItem(this._storageKey));};__cov_qRk17qMaNpKVEzeLYLR6dw.s['26']++;ActivitySyncer.prototype.clear=function(){__cov_qRk17qMaNpKVEzeLYLR6dw.f['11']++;__cov_qRk17qMaNpKVEzeLYLR6dw.s['27']++;LocStorage.removeItem(this._storageKey);};__cov_qRk17qMaNpKVEzeLYLR6dw.s['28']++;ActivitySyncer.prototype.attachListener=function(eventListener,context){__cov_qRk17qMaNpKVEzeLYLR6dw.f['12']++;__cov_qRk17qMaNpKVEzeLYLR6dw.s['29']++;var wrappedListener=Y.bind(function(evt){__cov_qRk17qMaNpKVEzeLYLR6dw.f['13']++;__cov_qRk17qMaNpKVEzeLYLR6dw.s['30']++;var wrappedValue=(__cov_qRk17qMaNpKVEzeLYLR6dw.b['8'][0]++,this._getWrappedValue())||(__cov_qRk17qMaNpKVEzeLYLR6dw.b['8'][1]++,{}),modifiedTime=wrappedValue.timestamp;__cov_qRk17qMaNpKVEzeLYLR6dw.s['31']++;if((__cov_qRk17qMaNpKVEzeLYLR6dw.b['10'][0]++,modifiedTime)&&(__cov_qRk17qMaNpKVEzeLYLR6dw.b['10'][1]++,modifiedTime!==this._lastModifiedTime)){__cov_qRk17qMaNpKVEzeLYLR6dw.b['9'][0]++;__cov_qRk17qMaNpKVEzeLYLR6dw.s['32']++;eventListener.call(context,{originalEvent:evt,key:this._storageKey,value:this.get()});__cov_qRk17qMaNpKVEzeLYLR6dw.s['33']++;this._lastModifiedTime=modifiedTime;}else{__cov_qRk17qMaNpKVEzeLYLR6dw.b['9'][1]++;}},this);__cov_qRk17qMaNpKVEzeLYLR6dw.s['34']++;this._listeners[eventListener]=wrappedListener;__cov_qRk17qMaNpKVEzeLYLR6dw.s['35']++;_addStorageChangeEventListener(wrappedListener);};__cov_qRk17qMaNpKVEzeLYLR6dw.s['36']++;ActivitySyncer.prototype.detachListener=function(eventListener){__cov_qRk17qMaNpKVEzeLYLR6dw.f['14']++;__cov_qRk17qMaNpKVEzeLYLR6dw.s['37']++;_removeStorageChangeEventListener(this._listeners[eventListener]);};__cov_qRk17qMaNpKVEzeLYLR6dw.s['38']++;ActivitySyncer.prototype.detachAllListeners=function(){__cov_qRk17qMaNpKVEzeLYLR6dw.f['15']++;__cov_qRk17qMaNpKVEzeLYLR6dw.s['39']++;for(var eventListener in this._listeners){__cov_qRk17qMaNpKVEzeLYLR6dw.s['40']++;if(this._listeners.hasOwnProperty(eventListener)){__cov_qRk17qMaNpKVEzeLYLR6dw.b['11'][0]++;__cov_qRk17qMaNpKVEzeLYLR6dw.s['41']++;this.detachListener(eventListener);}else{__cov_qRk17qMaNpKVEzeLYLR6dw.b['11'][1]++;}}};__cov_qRk17qMaNpKVEzeLYLR6dw.s['42']++;Y.namespace('COW').ActivitySyncer=ActivitySyncer;},'7.9.0',{'requires':['json-stringify','json-parse']});
