/*!
Copyright (c) 2010, Yahoo! Inc. All rights reserved.
Code licensed under the BSD License:
http://developer.yahoo.com/yui/license.html
version: 2.8.2r1
*/
(function(){var d=YAHOO,b=d.util,a=d.lang,c;if(!b.Storage){c=function(e){d.log("Exception in YAHOO.util.Storage.?? - must be extended by a storage engine".replace("??",e).replace("??",this.getName?this.getName():"Unknown"),"error");};b.Storage=function(e,g,f){var h=this;d.env._id_counter+=1;h._cfg=a.isObject(f)?f:{};h._location=e;h._name=g;h.isReady=false;h.createEvent(h.CE_READY,{scope:h});h.createEvent(h.CE_CHANGE,{scope:h});h.subscribe(h.CE_READY,function(){h.isReady=true;});};b.Storage.prototype={CE_READY:"YUIStorageReady",CE_CHANGE:"YUIStorageChange",DELIMITER:"__",_cfg:"",_name:"",_location:"",length:0,isReady:false,clear:function(){this._clear();this.length=0;},getItem:function(e){d.log("Fetching item at  "+e);var f=this._getItem(e);return a.isValue(f)?this._getValue(f):null;},getName:function(){return this._name;},hasKey:function(e){return a.isString(e)&&this._hasKey(e);},key:function(e){d.log("Fetching key at "+e);if(a.isNumber(e)&&-1<e&&this.length>e){var f=this._key(e);if(f){return f;}}throw ("INDEX_SIZE_ERR - Storage.setItem - The provided index ("+e+") is not available");},removeItem:function(f){d.log("removing "+f);if(this.hasKey(f)){var e=this._getItem(f);if(!e){e=null;}this._removeItem(f);this.fireEvent(this.CE_CHANGE,new b.StorageEvent(this,f,e,null,b.StorageEvent.TYPE_REMOVE_ITEM));}else{}},setItem:function(g,h){d.log("SETTING "+h+" to "+g);if(a.isString(g)){var f=this.hasKey(g)?b.StorageEvent.TYPE_UPDATE_ITEM:b.StorageEvent.TYPE_ADD_ITEM,e=this._getItem(g);if(!e){e=null;}if(this._setItem(g,this._createValue(h))){this.fireEvent(this.CE_CHANGE,new b.StorageEvent(this,g,e,h,f));}else{throw ("QUOTA_EXCEEDED_ERROR - Storage.setItem - The choosen storage method ("+this.getName()+") has exceeded capacity");}}else{}},_clear:function(){c("_clear");return"";},_createValue:function(f){var e=(a.isNull(f)||a.isUndefined(f))?(""+f):typeof f;return"string"===e?f:e+this.DELIMITER+f;},_getItem:function(e){c("_getItem");return"";},_getValue:function(f){var e=f?f.split(this.DELIMITER):[];if(1==e.length){return f;}switch(e[0]){case"boolean":return"true"===e[1];case"number":return parseFloat(e[1]);case"null":return null;default:return e[1];}},_key:function(e){c("_key");return"";},_hasKey:function(e){return null!==this._getItem(e);},_removeItem:function(e){c("_removeItem");return"";},_setItem:function(e,f){c("_setItem");return"";}};a.augmentProto(b.Storage,b.EventProvider);}}());(function(){var h=YAHOO.util,b=YAHOO.lang,e={},g=[],f={},c=function(i){return(i&&i.isAvailable())?i:null;},a=function(j,i,k){var l=e[j+i.ENGINE_NAME];if(!l){l=new i(j,k);e[j+i.ENGINE_NAME]=l;}return l;},d=function(i){switch(i){case h.StorageManager.LOCATION_LOCAL:case h.StorageManager.LOCATION_SESSION:return i;default:return h.StorageManager.LOCATION_SESSION;}};h.StorageManager={LOCATION_SESSION:"sessionStorage",LOCATION_LOCAL:"localStorage",get:function(q,l,o){var m=b.isObject(o)?o:{},k=c(f[q]);if(!k&&!m.force){var p,n;if(m.order){n=m.order.length;for(p=0;p<n&&!k;p+=1){k=c(m.order[p]);}}if(!k){n=g.length;for(p=0;p<n&&!k;p+=1){k=c(g[p]);}}}if(k){return a(d(l),k,m.engine);}throw ("YAHOO.util.StorageManager.get - No engine available, please include an engine before calling this function.");},getByteSize:function(i){return encodeURIComponent(""+i).length;},register:function(i){if(b.isFunction(i)&&b.isFunction(i.isAvailable)&&b.isString(i.ENGINE_NAME)){f[i.ENGINE_NAME]=i;g.push(i);return true;}return false;}};YAHOO.register("StorageManager",h.SWFStore,{version:"2.8.2r1",build:"7"});}());(function(){YAHOO.util.StorageEvent=function(d,b,a,e,c){this.key=b;this.oldValue=a;this.newValue=e;this.url=window.location.href;this.window=window;this.storageArea=d;this.type=c;};YAHOO.lang.augmentObject(YAHOO.util.StorageEvent,{TYPE_ADD_ITEM:"addItem",TYPE_REMOVE_ITEM:"removeItem",TYPE_UPDATE_ITEM:"updateItem"});YAHOO.util.StorageEvent.prototype={key:null,newValue:null,oldValue:null,source:null,storageArea:null,type:null,url:null};}());(function(){var b=YAHOO.util,a=YAHOO.lang;b.StorageEngineKeyed=function(){b.StorageEngineKeyed.superclass.constructor.apply(this,arguments);this._keys=[];this._keyMap={};};a.extend(b.StorageEngineKeyed,b.Storage,{_keys:null,_keyMap:null,_addKey:function(c){this._keyMap[c]=this.length;this._keys.push(c);this.length=this._keys.length;},_indexOfKey:function(d){var c=this._keyMap[d];return undefined===c?-1:c;},_removeKey:function(e){var d=this._indexOfKey(e),f=this._keys.slice(d+1);delete this._keyMap[e];for(var c in this._keyMap){if(d<this._keyMap[c]){this._keyMap[c]-=1;}}this._keys.length=d;this._keys=this._keys.concat(f);this.length=this._keys.length;}});}());(function(){var d=YAHOO.util,b=YAHOO.lang,a=function(e){if(e.begin){e.begin();}},c=function(e){if(e.commit){e.commit();}};d.StorageEngineHTML5=function(e,f){var g=this;d.StorageEngineHTML5.superclass.constructor.call(g,e,d.StorageEngineHTML5.ENGINE_NAME,f);g._engine=window[e];g.length=g._engine.length;b.later(250,g,function(){g.fireEvent(g.CE_READY);});};YAHOO.lang.extend(d.StorageEngineHTML5,d.Storage,{_engine:null,_clear:function(){var g=this;if(g._engine.clear){g._engine.clear();}else{for(var f=g.length,e;0<=f;f-=1){e=g._key(f);g._removeItem(e);}}},_getItem:function(e){var f=this._engine.getItem(e);return b.isObject(f)?f.value:f;},_key:function(e){return this._engine.key(e);},_removeItem:function(e){var f=this;a(f._engine);f._engine.removeItem(e);c(f._engine);f.length=f._engine.length;},_setItem:function(f,g){var i=this;try{a(i._engine);i._engine.setItem(f,g);c(i._engine);i.length=i._engine.length;return true;}catch(h){return false;}}},true);d.StorageEngineHTML5.ENGINE_NAME="html5";d.StorageEngineHTML5.isAvailable=function(){return window.localStorage;};d.StorageManager.register(d.StorageEngineHTML5);}());(function(){var g=YAHOO.util,b=YAHOO.lang,d=9948,c="YUIStorageEngine",f=null,e=encodeURIComponent,a=decodeURIComponent;g.StorageEngineGears=function(i,l){var o=this;g.StorageEngineGears.superclass.constructor.call(o,i,g.StorageEngineGears.ENGINE_NAME,l);if(!f){f=google.gears.factory.create(g.StorageEngineGears.GEARS);f.open(window.location.host+"-"+g.StorageEngineGears.DATABASE);f.execute("CREATE TABLE IF NOT EXISTS "+c+" (key TEXT, location TEXT, value TEXT)");}var k=g.StorageManager.LOCATION_SESSION===o._location,h=g.Cookie.get("sessionKey"+g.StorageEngineGears.ENGINE_NAME);if(!h){f.execute("BEGIN");f.execute("DELETE FROM "+c+' WHERE location="'+e(g.StorageManager.LOCATION_SESSION)+'"');f.execute("COMMIT");}var j=f.execute("SELECT key FROM "+c+' WHERE location="'+e(o._location)+'"'),n={};try{while(j.isValidRow()){var m=a(j.field(0));if(!n[m]){n[m]=true;o._addKey(m);}j.next();}}finally{j.close();}if(k){g.Cookie.set("sessionKey"+g.StorageEngineGears.ENGINE_NAME,true);}o.length=o._keys.length;b.later(250,o,function(){o.fireEvent(o.CE_READY);});};b.extend(g.StorageEngineGears,g.StorageEngineKeyed,{_clear:function(){f.execute("BEGIN");f.execute("DELETE FROM "+c+' WHERE location="'+e(this._location)+'"');f.execute("COMMIT");this._keys=[];this.length=0;},_getItem:function(j){var i=f.execute("SELECT value FROM "+c+' WHERE key="'+e(j)+'" AND location="'+e(this._location)+'"'),k="";try{while(i.isValidRow()){var h=i.field(0);k+=i.field(0);i.next();}}finally{i.close();}return k?a(k):null;},_key:function(h){return this._keys[h];},_removeItem:function(h){f.execute("BEGIN");f.execute("DELETE FROM "+c+' WHERE key="'+e(h)+'" AND location="'+e(this._location)+'"');f.execute("COMMIT");this._removeKey(h);},_setItem:function(t,q){if(!this.hasKey(t)){this._addKey(t);}var h=e(t),u=e(this._location),v=e(q),o=[],s=d-(h+u).length;if(s<v.length){for(var r=0,p=v.length;r<p;r+=s){o.push(v.substr(r,s));}}else{o.push(v);}f.execute("BEGIN");f.execute("DELETE FROM "+c+' WHERE key="'+e(t)+'" AND location="'+e(this._location)+'"');for(var l=0,k=o.length;l<k;l+=1){f.execute("INSERT INTO "+c+' VALUES ("'+h+'", "'+u+'", "'+o[l]+'")');}f.execute("COMMIT");return true;}});g.Event.on("unload",function(){if(f){f.close();}});g.StorageEngineGears.ENGINE_NAME="gears";g.StorageEngineGears.GEARS="beta.database";g.StorageEngineGears.DATABASE="yui.database";g.StorageEngineGears.isAvailable=function(){if(window.google&&window.google.gears){try{google.gears.factory.create(g.StorageEngineGears.GEARS);return true;}catch(h){}}return false;};g.StorageManager.register(g.StorageEngineGears);}());(function(){var g=YAHOO.util,b=YAHOO.lang,h=g.Dom,c=215,e=138,f=null,d=function(j,i){return j._location+j.DELIMITER+i;},a=function(j){if(!f){if(!b.isString(j.swfURL)){j.swfURL=g.StorageEngineSWF.SWFURL;}if(!j.containerID){var k=document.getElementsByTagName("body")[0],i=k.appendChild(document.createElement("div"));j.containerID=h.generateId(i);}if(!j.attributes){j.attributes={};}if(!j.attributes.flashVars){j.attributes.flashVars={};}j.attributes.flashVars.useCompression="true";j.attributes.version=9.115;f=new YAHOO.widget.SWF(j.containerID,j.swfURL,j.attributes);}};g.StorageEngineSWF=function(i,j){var k=this;g.StorageEngineSWF.superclass.constructor.call(k,i,g.StorageEngineSWF.ENGINE_NAME,j);a(k._cfg);f.unsubscribe("contentReady");f.addListener("contentReady",function(){k._swf=f._swf;f.initialized=true;var n=g.StorageManager.LOCATION_SESSION===k._location,m=g.Cookie.get("sessionKey"+g.StorageEngineSWF.ENGINE_NAME);for(var p=f.callSWF("getLength",[])-1;0<=p;p-=1){var o=f.callSWF("getNameAt",[p]),l=-1<o.indexOf(g.StorageManager.LOCATION_SESSION+k.DELIMITER);if(n&&!m){f.callSWF("removeItem",[o]);}else{if(n===l){k._addKey(o);}}}if(n){g.Cookie.set("sessionKey"+g.StorageEngineSWF.ENGINE_NAME,true);}k.length=k._keys.length;k.fireEvent(k.CE_READY);});if(f.initialized){f.fireEvent("contentReady");}};b.extend(g.StorageEngineSWF,g.StorageEngineKeyed,{_swf:null,_clear:function(){for(var k=this._keys.length-1;0<=k;k-=1){var j=this._keys[k];f.callSWF("removeItem",[j]);}this._keys=[];this.length=0;},_getItem:function(i){var j=d(this,i);return f.callSWF("getValueOf",[j]);},_key:function(i){return(this._keys[i]||"").replace(/^.*?__/,"");},_removeItem:function(i){var j=d(this,i);f.callSWF("removeItem",[j]);this._removeKey(j);},_setItem:function(i,k){var j=d(this,i),l;if(f.callSWF("getValueOf",[j])){this._removeItem(i);}this._addKey(j);if(f.callSWF("setItem",[j,k])){return true;}else{l=h.get(f._id);if(c>h.getStyle(l,"width").replace(/\D+/g,"")){h.setStyle(l,"width",c+"px");}if(e>h.getStyle(l,"height").replace(/\D+/g,"")){h.setStyle(l,"height",e+"px");}return f.callSWF("displaySettings",[]);}}});g.StorageEngineSWF.SWFURL="swfstore.swf";g.StorageEngineSWF.ENGINE_NAME="swf";g.StorageEngineSWF.isAvailable=function(){return(6<=YAHOO.env.ua.flash&&YAHOO.widget.SWF);};g.StorageManager.register(g.StorageEngineSWF);}());YAHOO.register("storage",YAHOO.util.Storage,{version:"2.8.2r1",build:"7"});